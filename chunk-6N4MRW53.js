import{h as nt,i as ot,k as lt}from"./chunk-FJK5ZZIC.js";import{B as it,Oa as C,W as w,Z as at,aa as b,ec as K,gc as q,oa as Y,p as rt}from"./chunk-E233IHIW.js";import{a as P,b as st}from"./chunk-7HGKORF3.js";var j=class{constructor(t,e=[],o=[]){this.condition=t;this.questions=e;this.items=o;}},W=class{constructor(t,e){this.question=t;this.variable=e;}static NEW_QUESTION_NAME="Neue Frage";static NEW_VARIABLE_NAME="new_variable";},F=class{constructor(t,e,o){this.category=t;this.name=e;this.weight=o;}static NEW_ITEM_NAME="Neuer Gegenstand";static NEW_CATEGORY_NAME="Neu";},k=class{constructor(t){this.variable=t;}evaluate(t){return t[this.variable];}},ct=class n extends k{static string="please_select";constructor(){super(n.string);}},H=class n extends k{static string="always";constructor(){super(n.string);}evaluate(){return!0;}},N=class{constructor(t){this.not=t;}evaluate(t){return!this.not.evaluate(t);}},V=class{constructor(t,e){this.left=t;this.right=e;}evaluate(t){return this.left.evaluate(t)&&this.right.evaluate(t);}},z=class{constructor(t,e){this.left=t;this.right=e;}evaluate(t){return this.left.evaluate(t)||this.right.evaluate(t);}};var ne=class n{serializeRules(t){return t.map(this.serialize.bind(this)).map(e=>e+";").join(`

`);}serializeEffects(t){return t.questions.map(this.serialize.bind(this)).concat(t.items.map(this.serialize.bind(this)));}serializeWeight(t,e,o=-1){if(!t)return"0g";let f=(o<0?t/1e3:(t/1e3).toFixed(o)).toString()+"kg",h=(t*1).toString()+"g";return e?e==="kg"?f:h:f.length<=h.length?f:h;}serialize(t){if(t instanceof j){let o=[];if(!(t.condition instanceof H)){let h=this.serialize(t.condition);h&&o.push(h," ");}o.push(":-");let f=this.serializeEffects(t);if(f.length===1&&o.length===1)o.push(" ",f[0]);else for(let h=0;h<f.length;h++){let $=f[h];h>0&&o.push(","),o.push(`
`,"   ",$);}return o.join("");}else{if(t instanceof W)return t.question+" $"+t.variable;if(t instanceof F){let o=`[${t.category}] ${t.name}`.trim();return t.weight&&(o+=" "+this.serializeWeight(t.weight)),o;}else{if(t instanceof k)return t.variable;if(t instanceof N)return"NOT "+this.serialize(t.not);if(t instanceof V)return this.serialize(t.left)+" AND "+this.serialize(t.right);if(t instanceof z)return this.serialize(t.left)+" OR "+this.serialize(t.right);}}let e=t;throw new Error("Cannot serialize unknown input",e);}static ɵfac=function(e){return new(e||n)();};static ɵprov=w({token:n,factory:n.ɵfac,providedIn:"root"});};function us(n,t){let e=t.filter(f=>f instanceof W),o=t.filter(f=>f instanceof F);return new j(n??new H(),e,o);}function ut(n){return n.length===1?n[0]:new V(n[0],ut(n.slice(1)));}function ft(n){return n.length===1?n[0]:new z(n[0],ft(n.slice(1)));}function fs(n,t){function e(){this.constructor=n;}e.prototype=t.prototype,n.prototype=new e();}function D(n,t,e,o){var f=Error.call(this,n);return Object.setPrototypeOf&&Object.setPrototypeOf(f,D.prototype),f.expected=t,f.found=e,f.location=o,f.name="SyntaxError",f;}fs(D,Error);function Te(n,t,e){return e=e||" ",n.length>t?n:(t-=n.length,e+=e.repeat(t),n+e.slice(0,t));}D.prototype.format=function(n){var t="Error: "+this.message;if(this.location){var e=null,o;for(o=0;o<n.length;o++)if(n[o].source===this.location.source){e=n[o].text.split(/\r\n|\n|\r/g);break;}var f=this.location.start,h=this.location.source&&typeof this.location.source.offset=="function"?this.location.source.offset(f):f,$=this.location.source+":"+h.line+":"+h.column;if(e){var x=this.location.end,M=Te("",h.line.toString().length," "),y=e[f.line-1],g=f.line===x.line?x.column:y.length+1,m=g-f.column||1;t+=`
 --> `+$+`
`+M+` |
`+h.line+" | "+y+`
`+M+" | "+Te("",f.column-1," ")+Te("",m,"^");}else t+=`
 at `+$;}return t;};D.buildMessage=function(n,t){var e={literal:function(y){return'"'+f(y.text)+'"';},class:function(y){var g=y.parts.map(function(m){return Array.isArray(m)?h(m[0])+"-"+h(m[1]):h(m);});return"["+(y.inverted?"^":"")+g.join("")+"]";},any:function(){return"any character";},end:function(){return"end of input";},other:function(y){return y.description;}};function o(y){return y.charCodeAt(0).toString(16).toUpperCase();}function f(y){return y.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(g){return"\\x0"+o(g);}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(g){return"\\x"+o(g);});}function h(y){return y.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(g){return"\\x0"+o(g);}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(g){return"\\x"+o(g);});}function $(y){return e[y.type](y);}function x(y){var g=y.map($),m,E;if(g.sort(),g.length>0){for(m=1,E=1;m<g.length;m++)g[m-1]!==g[m]&&(g[E]=g[m],E++);g.length=E;}switch(g.length){case 1:return g[0];case 2:return g[0]+" or "+g[1];default:return g.slice(0,-1).join(", ")+", or "+g[g.length-1];}}function M(y){return y?'"'+f(y)+'"':"end of input";}return"Expected "+x(n)+" but "+M(t)+" found.";};function O(n,t){t=t!==void 0?t:{};var e={},o=t.grammarSource,f={Rules:Le,Rule:de,Condition:He,Effects:Ye,Question:me,Item:Se,VariableName:ve,QuestionString:Be,ItemNameAndWeight:Ze,CategoryName:Ge},h=Le,$=";",x=":-",M="OR",y="AND",g="NOT",m=",",E="$",Q="[",yt="]",ke="kg",mt="g",vt=".",Ee=/^[^$,;#]/,St=/^[a-zA-Z]/,Ae=/^[a-zA-Z0-9\-[\](){}_]/,Ce=/^[^\],;#[]/,bt=/^[,;]/,We=/^[^ ,;#]/,se=/^[0-9]/,Oe=/^[ \t\n\r]/,Tt=R("rule end"),Kt=I(";",!1),wt=R("rule"),$t=I(":-",!1),re=R("condition"),Rt=I("OR",!1),xt=I("AND",!1),he=I("NOT",!1),It=I(",",!1),Me=R("question"),kt=I("$",!1),Pe=L(["$",",",";","#"],!0,!1),Et=R("variable name"),At=L([["a","z"],["A","Z"]],!1,!1),je=L([["a","z"],["A","Z"],["0","9"],"-","[","]","(",")","{","}","_"],!1,!1),Ct=R("item"),Wt=R("category"),Ot=I("[",!1),Mt=I("]",!1),Pt=R("category name"),Ne=L(["]",",",";","#","["],!0,!1),jt=R("item name"),Nt=R("word"),Vt=L([",",";"],!1,!1),Ve=L([" ",",",";","#"],!0,!1),zt=R("weight"),Ft=I("kg",!1),Dt=I("g",!1),Qt=R("number"),ie=L([["0","9"]],!1,!1),Lt=I(".",!1),qt=R("whitespace"),ze=L([" ","	",`
`,"\r"],!1,!1),Ht=as(),Ut=function(s,r){return us(s,r);},Jt=function(s){return ft(s);},Yt=function(s){return ut(s);},Bt=function(s){return new N(s);},Gt=function(s){return new k(s);},Zt=function(s,r){return new W(s.trim(),r.trim());},Xt=function(s,r){let{name:a,weight:l}=r;return new F(s.trim(),a,l);},_t=function(s,r){return t.trackWeight;},es=function(s,r){let a=s.trim();return a.length||Fe("item name"),{name:a,weight:r};},ts=function(s){let r=s.trim();return r.length||Fe("item name"),{name:r,weight:void 0};},ss=function(s){return s*1e3;},rs=function(){return parseFloat(is());},i=t.peg$currPos|0,T=i,J=[{line:1,column:1}],A=i,ae=t.peg$maxFailExpected||[],c=t.peg$silentFails|0,Z;if(t.startRule){if(!(t.startRule in f))throw new Error(`Can't start parsing from rule "`+t.startRule+'".');h=f[t.startRule];}function is(){return n.substring(T,i);}function ys(){return T;}function ms(){return{source:o,start:T,end:i};}function vs(){return X(T,i);}function Fe(s,r){throw r=r!==void 0?r:X(T,i),Qe([R(s)],n.substring(T,i),r);}function Ss(s,r){throw r=r!==void 0?r:X(T,i),os(s,r);}function I(s,r){return{type:"literal",text:s,ignoreCase:r};}function L(s,r,a){return{type:"class",parts:s,inverted:r,ignoreCase:a};}function as(){return{type:"any"};}function ns(){return{type:"end"};}function R(s){return{type:"other",description:s};}function De(s){var r=J[s],a;if(r)return r;if(s>=J.length)a=J.length-1;else for(a=s;!J[--a];);for(r=J[a],r={line:r.line,column:r.column};a<s;)n.charCodeAt(a)===10?(r.line++,r.column=1):r.column++,a++;return J[s]=r,r;}function X(s,r,a){var l=De(s),u=De(r),d={source:o,start:{offset:s,line:l.line,column:l.column},end:{offset:r,line:u.line,column:u.column}};return a&&o&&typeof o.offset=="function"&&(d.start=o.offset(d.start),d.end=o.offset(d.end)),d;}function p(s){i<A||(i>A&&(A=i,ae=[]),ae.push(s));}function os(s,r){return new D(s,null,null,r);}function Qe(s,r,a){return new D(D.buildMessage(s,r),s,r,a);}function Le(){var s,r,a,l,u,d;for(s=i,r=v(),a=[],l=de();l!==e;)a.push(l),l=i,u=qe(),u!==e?(u=de(),u===e?(i=l,l=e):l=u):l=u;return l=qe(),l===e&&(l=null),u=v(),d=tt(),d!==e?s=a:(i=s,s=e),s;}function qe(){var s,r,a,l;return c++,s=i,r=v(),n.charCodeAt(i)===59?(a=$,i++):(a=e,c===0&&p(Kt)),a!==e?(l=v(),r=[r,a,l],s=r):(i=s,s=e),c--,s===e&&(r=e,c===0&&p(Tt)),s;}function de(){var s,r,a,l,u,d;return c++,s=i,r=He(),r===e&&(r=null),a=v(),n.substr(i,2)===x?(l=x,i+=2):(l=e,c===0&&p($t)),l!==e?(u=v(),d=Ye(),T=s,s=Ut(r,d)):(i=s,s=e),c--,s===e&&(r=e,c===0&&p(wt)),s;}function He(){var s,r;return c++,s=ls(),c--,s===e&&(r=e,c===0&&p(re)),s;}function ls(){var s,r,a,l,u,d,S,_;for(c++,s=i,r=i,a=[],l=Ue();l!==e;)a.push(l),l=i,u=i,d=v(),n.substr(i,2)===M?(S=M,i+=2):(S=e,c===0&&p(Rt)),S!==e?(_=v(),d=[d,S,_],u=d):(i=u,u=e),u!==e?(u=Ue(),u===e?(i=l,l=e):l=u):l=u;return a.length<1?(i=r,r=e):r=a,r!==e&&(T=s,r=Jt(r)),s=r,c--,s===e&&(r=e,c===0&&p(re)),s;}function Ue(){var s,r,a,l,u,d,S,_;for(c++,s=i,r=i,a=[],l=ye();l!==e;)a.push(l),l=i,u=i,d=v(),n.substr(i,3)===y?(S=y,i+=3):(S=e,c===0&&p(xt)),S!==e?(_=v(),d=[d,S,_],u=d):(i=u,u=e),u!==e?(u=ye(),u===e?(i=l,l=e):l=u):l=u;return a.length<1?(i=r,r=e):r=a,r!==e&&(T=s,r=Yt(r)),s=r,c--,s===e&&(r=e,c===0&&p(re)),s;}function ye(){var s,r,a,l,u,d;return c++,s=i,n.substr(i,3)===g?(r=g,i+=3):(r=e,c===0&&p(he)),r!==e?(a=v(),n.substr(i,3)===g?(l=g,i+=3):(l=e,c===0&&p(he)),l!==e?(u=v(),d=ye(),d!==e?s=d:(i=s,s=e)):(i=s,s=e)):(i=s,s=e),s===e&&(s=i,n.substr(i,3)===g?(r=g,i+=3):(r=e,c===0&&p(he)),r!==e?(a=v(),l=Je(),l!==e?(T=s,s=Bt(l)):(i=s,s=e)):(i=s,s=e),s===e&&(s=i,r=Je(),r!==e?s=r:(i=s,s=e))),c--,s===e&&(r=e,c===0&&p(re)),s;}function Je(){var s,r;return s=i,r=ve(),r!==e&&(T=s,r=Gt(r)),s=r,s;}function Ye(){var s,r,a,l,u,d,S;for(s=i,r=[],a=me(),a===e&&(a=Se());a!==e;)r.push(a),a=i,l=i,u=v(),n.charCodeAt(i)===44?(d=m,i++):(d=e,c===0&&p(It)),d!==e?(S=v(),u=[u,d,S],l=u):(i=l,l=e),l!==e?(l=me(),l===e&&(l=Se()),l===e?(i=a,a=e):a=l):a=l;return s=r,s;}function me(){var s,r,a,l;return c++,s=i,r=Be(),r!==e?(n.charCodeAt(i)===36?(a=E,i++):(a=e,c===0&&p(kt)),a!==e?(l=ve(),l!==e?(T=s,s=Zt(r,l)):(i=s,s=e)):(i=s,s=e)):(i=s,s=e),c--,s===e&&(r=e,c===0&&p(Me)),s;}function Be(){var s,r,a;if(c++,s=i,r=[],a=n.charAt(i),Ee.test(a)?i++:(a=e,c===0&&p(Pe)),a!==e)for(;a!==e;)r.push(a),a=n.charAt(i),Ee.test(a)?i++:(a=e,c===0&&p(Pe));else r=e;return r!==e?s=n.substring(s,i):s=r,c--,s===e&&(r=e,c===0&&p(Me)),s;}function ve(){var s,r,a,l,u;if(c++,s=i,r=i,a=n.charAt(i),St.test(a)?i++:(a=e,c===0&&p(At)),a!==e){for(l=[],u=n.charAt(i),Ae.test(u)?i++:(u=e,c===0&&p(je));u!==e;)l.push(u),u=n.charAt(i),Ae.test(u)?i++:(u=e,c===0&&p(je));a=[a,l],r=a;}else i=r,r=e;return r!==e?s=n.substring(s,i):s=r,c--,s===e&&(r=e,c===0&&p(Et)),s;}function Se(){var s,r,a,l;return c++,s=i,r=cs(),r!==e?(a=v(),l=Ze(),l!==e?(T=s,s=Xt(r,l)):(i=s,s=e)):(i=s,s=e),c--,s===e&&(r=e,c===0&&p(Ct)),s;}function cs(){var s,r,a,l,u,d;return c++,s=i,n.charCodeAt(i)===91?(r=Q,i++):(r=e,c===0&&p(Ot)),r!==e?(a=v(),l=Ge(),l!==e?(u=v(),n.charCodeAt(i)===93?(d=yt,i++):(d=e,c===0&&p(Mt)),d!==e?s=l:(i=s,s=e)):(i=s,s=e)):(i=s,s=e),c--,s===e&&(r=e,c===0&&p(Wt)),s;}function Ge(){var s,r,a;if(c++,s=i,r=[],a=n.charAt(i),Ce.test(a)?i++:(a=e,c===0&&p(Ne)),a!==e)for(;a!==e;)r.push(a),a=n.charAt(i),Ce.test(a)?i++:(a=e,c===0&&p(Ne));else r=e;return r!==e?s=n.substring(s,i):s=r,c--,s===e&&(r=e,c===0&&p(Pt)),s;}function Ze(){var s,r,a,l,u;for(c++,s=i,r=i,a=[],l=Xe();l!==e;)a.push(l),l=i,u=v(),u=Xe(),u===e?(i=l,l=e):l=u;if(r=n.substring(r,i),a=v(),l=_e(),l!==e?(T=i,u=_t(r,l),u?u=void 0:u=e,u!==e?(T=s,s=es(r,l)):(i=s,s=e)):(i=s,s=e),s===e){for(s=i,r=i,a=[],l=be();l!==e;)a.push(l),l=i,u=v(),u=be(),u===e?(i=l,l=e):l=u;r=n.substring(r,i),T=s,r=ts(r),s=r;}return c--,s===e&&(r=e,c===0&&p(jt)),s;}function Xe(){var s,r,a,l,u,d;return c++,s=i,r=i,c++,a=i,l=_e(),l!==e?(u=v(),d=tt(),d===e&&(d=n.charAt(i),bt.test(d)?i++:(d=e,c===0&&p(Vt))),d!==e?(l=[l,u,d],a=l):(i=a,a=e)):(i=a,a=e),c--,a===e?r=void 0:(i=r,r=e),r!==e?(a=be(),a!==e?s=a:(i=s,s=e)):(i=s,s=e),c--,s===e&&(r=e,c===0&&p(Nt)),s;}function be(){var s,r,a;if(s=i,r=[],a=n.charAt(i),We.test(a)?i++:(a=e,c===0&&p(Ve)),a!==e)for(;a!==e;)r.push(a),a=n.charAt(i),We.test(a)?i++:(a=e,c===0&&p(Ve));else r=e;return r!==e?s=n.substring(s,i):s=r,s;}function _e(){var s,r,a;return c++,s=i,r=et(),r!==e?(n.substr(i,2)===ke?(a=ke,i+=2):(a=e,c===0&&p(Ft)),a!==e?(T=s,s=ss(r)):(i=s,s=e)):(i=s,s=e),s===e&&(s=i,r=et(),r!==e?(n.charCodeAt(i)===103?(a=mt,i++):(a=e,c===0&&p(Dt)),a===e&&(a=null),s=r):(i=s,s=e)),c--,s===e&&(r=e,c===0&&p(zt)),s;}function et(){var s,r,a,l,u,d,S;if(c++,s=i,r=[],a=n.charAt(i),se.test(a)?i++:(a=e,c===0&&p(ie)),a!==e)for(;a!==e;)r.push(a),a=n.charAt(i),se.test(a)?i++:(a=e,c===0&&p(ie));else r=e;if(r!==e){if(a=i,n.charCodeAt(i)===46?(l=vt,i++):(l=e,c===0&&p(Lt)),l!==e){if(u=i,d=[],S=n.charAt(i),se.test(S)?i++:(S=e,c===0&&p(ie)),S!==e)for(;S!==e;)d.push(S),S=n.charAt(i),se.test(S)?i++:(S=e,c===0&&p(ie));else d=e;d!==e?u=n.substring(u,i):u=d,u!==e?(l=[l,u],a=l):(i=a,a=e);}else i=a,a=e;a===e&&(a=null),T=s,s=rs();}else i=s,s=e;return c--,s===e&&(r=e,c===0&&p(Qt)),s;}function v(){var s,r;for(c++,s=[],r=n.charAt(i),Oe.test(r)?i++:(r=e,c===0&&p(ze));r!==e;)s.push(r),r=n.charAt(i),Oe.test(r)?i++:(r=e,c===0&&p(ze));return c--,r=e,c===0&&p(qt),s;}function tt(){var s,r;return s=i,c++,n.length>i?(r=n.charAt(i),i++):(r=e,c===0&&p(Ht)),c--,r===e?s=void 0:(i=s,s=e),s;}if(Z=h(),t.peg$library)return{peg$result:Z,peg$currPos:i,peg$FAILED:e,peg$maxFailExpected:ae,peg$maxFailPos:A};if(Z!==e&&i===n.length)return Z;throw Z!==e&&i<n.length&&p(ns()),Qe(ae,A<n.length?n.charAt(A):null,A<n.length?X(A,A+1):X(A,A));}var gs={isTrackWeight:()=>!1},ps=new at("PARSER_CONFIG_PROVIDER"),B=class n{injector=b(Y);isTrackWeight(){return this.injector.get(ps,gs).isTrackWeight();}makeOptions(t,e={}){return{startRule:t,trackWeight:e.forceWeightTracking??this.isTrackWeight()};}parseCondition(t){return O(t,this.makeOptions("Condition"));}parseQuestion(t){return O(t,this.makeOptions("Question"));}parseItem(t,e){return O(t,this.makeOptions("Item",{forceWeightTracking:e}));}parseEffects(t){return O(t,this.makeOptions("Effects"));}parseRule(t){return O(t,this.makeOptions("Rule"));}parseRules(t){let e=t.split(/\r?\n/g).map(o=>o.replace(/#.*/,"")).join(`
`);try{return O(e,this.makeOptions("Rules"));}catch(o){let f=[];if(f.push("Fehler beim Parsen der Regeln"),o instanceof D){let h=o.location.start.line.toString(),$=o.location.start.column.toString();f.push(" at line ",h," column ",$),f.push(":",`
`,o.message);}else console.error(o);throw new Error(f.join(""));}}validateVariableName(t){O(t,this.makeOptions("VariableName"));}validateQuestionString(t){O(t,this.makeOptions("QuestionString"));}validateItemNameAndWeight(t){O(t,this.makeOptions("ItemNameAndWeight"));}validateCategoryName(t){O(t,this.makeOptions("CategoryName"));}static ɵfac=function(e){return new(e||n)();};static ɵprov=w({token:n,factory:n.ɵfac,providedIn:"root"});};var oe=class n{serializer=b(ne);parser=b(B);extractVariables(t){return t.reduce((e,o)=>[...e,...o.questions.map(f=>f.variable)],[]);}extractCategories(t){let e=new Set();for(let o of t)for(let f of o.items)e.add(f.category);return Array.from(e);}renameVariable(t,e,o){if(o instanceof Array)return o.map(h=>this.renameVariable(t,e,h));if(o instanceof W)return o.variable===t?new W(o.question,e):o;if(o instanceof j)return new j(this.renameVariable(t,e,o.condition),o.questions.map(h=>this.renameVariable(t,e,h)),o.items);if(o instanceof k)return o.variable===t?new k(e):o;if(o instanceof N)return new N(this.renameVariable(t,e,o.not));if(o instanceof V)return new V(this.renameVariable(t,e,o.left),this.renameVariable(t,e,o.right));if(o instanceof z)return new z(this.renameVariable(t,e,o.left),this.renameVariable(t,e,o.right));let f=o;throw new Error("Unknown item type",f);}filterActive(t){let e=t.rules.filter(f=>f.condition.evaluate(t.model)),o=this.extractVariables(e).reduce((f,h)=>st(P({},f),{[h]:t.model[h]}),{[H.string]:!0});return e.length===t.rules.length?{model:o,rules:e}:this.filterActive({model:o,rules:e});}contains(t,e){let o=e.toLowerCase();if(t instanceof j)return this.contains(t.condition,e)||t.questions.some(h=>this.contains(h,e))||t.items.some(h=>this.contains(h,e));if(t instanceof W)return t.question.toLowerCase().includes(o)||t.variable.toLowerCase().includes(o);if(t instanceof F)return t.category.toLowerCase().includes(o)||t.name.toLowerCase().includes(o);if(t instanceof k)return t.variable.toLowerCase().includes(o);if(t instanceof N)return this.contains(t.not,e);if(t instanceof V)return this.contains(t.left,e)||this.contains(t.right,e);if(t instanceof z)return this.contains(t.left,e)||this.contains(t.right,e);let f=t;throw new Error("Unknown item type",f);}countItemsAndWeights(t){return t.reduce((e,o)=>o.items.reduce((f,h)=>{let $;if(this.parser.isTrackWeight())$=h.weight?1:0;else{let{weight:x}=this.parser.parseItem(this.serializer.serialize(h),!0);$=x?1:0;}return{items:f.items+1,weights:f.weights+$};},e),{items:0,weights:0});}static ɵfac=function(e){return new(e||n)();};static ɵprov=w({token:n,factory:n.ɵfac,providedIn:"root"});};var gt=`:-
   [N\xFCtzliches] Papiertaschent\xFCcher,
   [N\xFCtzliches] Rucksack;

:- Reist du l\xE4nger als 3 Tage? $longer;

longer :-
   Hast du eine Waschmaschine oder einen W\xE4scheservice zur Verf\xFCgung? $laundry,
   Willst du arbeiten? $work,
   [Elektronik] Handy-Ladeger\xE4t,
   [Elektronik] Tablet;

longer AND NOT laundry :-
   [Kleidung] genug Hemden,
   [Kleidung] genug Unterw\xE4sche,
   [Kleidung] Ersatzhosen;

laundry :-
   [Kleidung] 3 Hemden,
   [Kleidung] 3 S\xE4tze Unterw\xE4sche;

work :-
   [Elektronik] Laptop;

:-
   Wird es sonnig sein? $sunny,
   Wird es regnerisch sein? $rainy,
   Reist du ins Ausland? $abroad;

sunny :-
   Erwartest du einen hohen UV-Index? $uv,
   [N\xFCtzliches] Sonnenbrille,
   [Kleidung] Kurze Hosen;

rainy :-
   [Kleidung] Regenjacke;

NOT rainy :-
   [Kleidung] Jacke;

NOT sunny :-
   [Kleidung] Lange Hosen;

uv :-
   [N\xFCtzliches] Sonnencreme;

abroad :-
   [Dokumente] Reisepass,
   [Dokumente] Visum;
`;function le(n,t){let e=n.getItem("state"),o;if(e){let f=JSON.parse(e);o=P(P({},t),f);}else o=P({},t);return o;}function pt(n,t){if(typeof n!=typeof t)return!1;if(n&&t&&typeof n=="object"){let e=Object.keys(n),o=Object.keys(t);return e.length===o.length&&e.every(f=>pt(n[f],t[f]));}return n===t;}function hs(n,t){let e=Object.keys(t).filter(o=>!pt(n[o],t[o])).map(o=>[o,n[o]]);return e.length===0?null:Object.fromEntries(e);}function ce(n,t,e){let o=hs(t,e);o===null?n.removeItem("state"):n.setItem("state",JSON.stringify(o));}var ht=["en","de"],ee={answers:{},checkedItems:[],collapsedCategories:[],rules:void 0,fadeOutDisabledRules:!1,highlightVariableStatus:!1,refactorVariables:!0,categorySorting:"alphabetically",trackWeight:!1,answersLocked:!1,theme:"system",fontSize:"normal",language:"auto",exportReminder:!1,lastExportHash:"",lastExportDate:0},Ke=Object.keys(ee),G=class n{state=le(localStorage,ee);injector=b(Y);signalMap=new Map();constructor(){this.loadLegacyState(),this.initializeSignals();}initializeSignals(){for(let t of Ke){let e=C(this.state[t]);q(()=>{let o=e();o!==this.state[t]&&(this.state[t]=o,this.persist());},{manualCleanup:!0,injector:this.injector}),this.signalMap.set(t,e);}}loadLegacyState(){if(localStorage.getItem("answers")&&(this.state.answers=JSON.parse(localStorage.getItem("answers")),localStorage.removeItem("answers")),localStorage.getItem("checkedItems")&&(this.state.checkedItems=JSON.parse(localStorage.getItem("checkedItems")),localStorage.removeItem("checkedItems")),localStorage.getItem("collapsedCategories")&&(this.state.collapsedCategories=JSON.parse(localStorage.getItem("collapsedCategories")),localStorage.removeItem("collapsedCategories")),localStorage.getItem("rules")&&(this.state.rules=localStorage.getItem("rules"),localStorage.removeItem("rules")),localStorage.getItem("config")){let t=JSON.parse(localStorage.getItem("config"));this.state.fadeOutDisabledRules=t.fadeOutDisabledRules,this.state.trackWeight=t.trackWeight,this.state.answersLocked=t.answersLocked,this.state.theme=t.theme,this.state.language=t.language,localStorage.removeItem("config");}this.persist();}persist(){ce(localStorage,this.state,ee);}handles(t){return Ke.includes(t);}signal(t){return this.signalMap.get(t);}set(t,e){this.signal(t).set(e);}get(t){return this.signal(t)();}reset(){this.state=P({},ee),this.persist(),Ke.forEach(t=>{this.signal(t).set(ee[t]);});}static ɵfac=function(e){return new(e||n)();};static ɵprov=w({token:n,factory:n.ɵfac,providedIn:"root"});};var ue=class n{state=b(G);parser=b(B);refactor=b(oe);signalMap=new Map();constructor(){this.initializeSignals();}initializeSignals(){this.signalMap.set("isMobile",K(()=>{let g=navigator.userAgent;return /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|Mobile|mobile|CriOS/i.test(g);}));let t=C(window.scrollY);window.addEventListener("scroll",()=>{t.set(window.scrollY);}),this.signalMap.set("scrollY",t.asReadonly()),this.signalMap.set("preferredLanguage",K(()=>{let g=this.state.signal("language")();return g==="auto"?navigator.languages.map(Q=>Q.split("-")[0]).find(Q=>ht.includes(Q))??"en":g;})),this.signalMap.set("rulesContainComments",K(()=>{let g=this.state.signal("rules")();return!!g&&g.includes("#");}));let e=K(()=>{let g=this.state.signal("rules")();return g||gt;});this.signalMap.set("rulesOrTemplate",e);let o=K(()=>{try{return{parsedRules:this.parser.parseRules(e()),ruleParserError:""};}catch(g){g instanceof Error?console.warn(g.message):console.error(g);let m=g instanceof Error?g.message:"An unknown error occurred";return{parsedRules:[],ruleParserError:m};}}),f=K(()=>{let{ruleParserError:g,parsedRules:m}=o();if(!g){let{items:E,weights:Q}=this.refactor.countItemsAndWeights(m);return Q/E;}return 0;});this.signalMap.set("percentageOfItemsWithWeights",f);let h=K(()=>o().parsedRules);this.signalMap.set("parsedRules",h),this.signalMap.set("ruleParserError",K(()=>o().ruleParserError)),this.signalMap.set("categories",K(()=>this.refactor.extractCategories(h()))),this.signalMap.set("variables",K(()=>this.refactor.extractVariables(h())));let $=K(()=>this.refactor.filterActive({rules:h(),model:this.state.signal("answers")()})),x=K(()=>$().rules);this.signalMap.set("activeRules",x),this.signalMap.set("activeAnswers",K(()=>$().model)),this.signalMap.set("activeQuestions",K(()=>x().flatMap(g=>g.questions))),this.signalMap.set("activeItems",K(()=>x().flatMap(g=>g.items)));let M=K(()=>ds(e()).toString(16));this.signalMap.set("rulesHash",M);let y=C(new Date().getTime());this.signalMap.set("lastRulesAction",y.asReadonly()),q(()=>{e(),y.set(new Date().getTime());}),this.signalMap.set("exportFileName",K(()=>{let g=new Date(y()).toISOString().replace(/\..*$/,"").replace(/[T:]/g,"-"),m=M();return`travel-packlist-rules-${g}-${m}.txt`;})),this.signalMap.set("exportNeeded",K(()=>{let g=this.signal("rulesHash")(),m=this.state.signal("lastExportHash")(),E=g!==m;return!!this.state.signal("rules")()&&E;}));}handles(t){return this.signalMap.has(t);}signal(t){return this.signalMap.get(t);}get(t){return this.signal(t)();}static ɵfac=function(e){return new(e||n)();};static ɵprov=w({token:n,factory:n.ɵfac,providedIn:"root"});},ds=function(n,t=0){let e=3735928559^t,o=1103547991^t;for(let f=0,h;f<n.length;f++)h=n.charCodeAt(f),e=Math.imul(e^h,2654435761),o=Math.imul(o^h,1597334677);return e=Math.imul(e^e>>>16,2246822507),e^=Math.imul(o^o>>>13,3266489909),o=Math.imul(o^o>>>16,2246822507),o^=Math.imul(e^e>>>13,3266489909),4294967296*(2097151&o)+(e>>>0);};var $e={rulesMode:"view",filterRulesQuery:void 0},we=Object.keys($e),fe=class n{route=b(ot);router=b(lt);signalMap=new Map();constructor(){for(let t of we)this.signalMap.set(t,this.createSignal(t));}createSignal(t){let e=C(void 0);return this.router.events.pipe(it(o=>o instanceof nt),rt(()=>this.route.snapshot.queryParams[t]??$e[t])).subscribe(o=>{o!==""&&e.set(o);}),q(()=>{let o=e()||void 0;o===$e[t]&&(o=void 0),this.route.snapshot.queryParams[t]!==o&&this.router.navigate([],{queryParams:{[t]:o},queryParamsHandling:"merge",relativeTo:this.route,replaceUrl:!0});}),e;}handles(t){return we.includes(t);}signal(t){return this.signalMap.get(t);}get(t){return this.signal(t)();}set(t,e){this.signal(t).set(e);}reset(){for(let t of we)this.signal(t).set(void 0);}static ɵfac=function(e){return new(e||n)();};static ɵprov=w({token:n,factory:n.ɵfac,providedIn:"root"});};var te={clipboardItems:[],clipboardQuestions:[]},Re=Object.keys(te),ge=class n{state=le(sessionStorage,te);injector=b(Y);signalMap=new Map();constructor(){this.initializeSignals();}initializeSignals(){for(let t of Re){let e=C(this.state[t]);q(()=>{let o=e();o!==this.state[t]&&(this.state[t]=o,this.persist());},{manualCleanup:!0,injector:this.injector}),this.signalMap.set(t,e);}}persist(){ce(sessionStorage,this.state,te);}handles(t){return Re.includes(t);}signal(t){return this.signalMap.get(t);}set(t,e){this.signal(t).set(e);}get(t){return this.signal(t)();}reset(){this.state=P({},te),this.persist(),Re.forEach(t=>{this.signal(t).set(te[t]);});}static ɵfac=function(e){return new(e||n)();};static ɵprov=w({token:n,factory:n.ɵfac,providedIn:"root"});};var Ie={serviceWorkerStatus:"init"},xe=Object.keys(Ie),pe=class n{signalMap=new Map();constructor(){this.initializeSignals();}initializeSignals(){for(let t of xe){let e=C(Ie[t]);this.signalMap.set(t,e);}}handles(t){return xe.includes(t);}signal(t){return this.signalMap.get(t);}get(t){return this.signal(t)();}set(t,e){this.signal(t).set(e);}reset(){for(let t of xe)this.signal(t).set(Ie[t]);}static ɵfac=function(e){return new(e||n)();};static ɵprov=w({token:n,factory:n.ɵfac,providedIn:"root"});};var dt=class n{persistent=b(G);router=b(fe);session=b(ge);transient=b(pe);derived=b(ue);get(t){if(this.persistent.handles(t))return this.persistent.get(t);if(this.router.handles(t))return this.router.get(t);if(this.session.handles(t))return this.session.get(t);if(this.transient.handles(t))return this.transient.get(t);if(this.derived.handles(t))return this.derived.get(t);throw new Error(`Key ${t} not handled in state`);}signal(t){if(this.persistent.handles(t))return this.persistent.signal(t);if(this.router.handles(t))return this.router.signal(t);if(this.session.handles(t))return this.session.signal(t);if(this.transient.handles(t))return this.transient.signal(t);if(this.derived.handles(t))return this.derived.signal(t);throw new Error(`Key ${t} not handled in state`);}set(t,e){if(this.persistent.handles(t))this.persistent.signal(t).set(e);else if(this.router.handles(t))this.router.set(t,e);else if(this.session.handles(t))this.session.set(t,e);else if(this.transient.handles(t))this.transient.set(t,e);else throw this.derived.handles(t)?new Error("Key is derived and cannot be set"):new Error(`Key ${t} not handled in state`);}reset(){this.persistent.reset(),this.session.reset(),this.router.reset();}static ɵfac=function(e){return new(e||n)();};static ɵprov=w({token:n,factory:n.ɵfac,providedIn:"root"});};export{j as a,W as b,F as c,k as d,ct as e,H as f,N as g,V as h,z as i,D as j,ps as k,B as l,ne as m,oe as n,dt as o};/**i18n:ce629f7757620cd455841d864165c42e946502d979ab9ef58d04496856a7546b*/