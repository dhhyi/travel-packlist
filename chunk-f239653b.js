import{b as h,d as w,i as D,o as K,q as X}from"./chunk-2f218f0f.js";import{a as z}from"./chunk-340e7b50.js";import{u as V}from"./chunk-fd75c108.js";import{l as L}from"./chunk-9f7bbd74.js";import"./chunk-ebb84b43.js";import{$b as y,D as $,Kb as s,Lb as E,Mb as S,Na as a,Nb as G,O as I,Qb as r,Ya as F,aa as C,bc as x,pb as P,qb as d,rb as O,tb as U,ub as v,vb as W,vc as T,wb as o,wc as c,xb as l,yb as b}from"./chunk-5cc3cef7.js";import"./chunk-0b432020.js";function B(e,t){e&1&&(o(0,"div",7),s(1,0),l());}function k(e,t){if(e&1&&(o(0,"div",8),s(1,1),l()),e&2){let n=r().rules;a(),E(n)(n),S(1);}}function q(e,t){if(e&1&&(o(0,"li"),s(1,2),l()),e&2){let _=r().$implicit;a(),E(_.variable),S(1);}}function j(e,t){if(e&1&&(o(0,"li"),s(1,3),l()),e&2){let _=r().$implicit;a(),E(_.variable),S(1);}}function H(e,t){if(e&1&&(o(0,"li"),s(1,4),l()),e&2){let _=r().$implicit;a(),E(_.variable),S(1);}}function J(e,t){if(e&1&&P(0,q,2,1,"li")(1,j,2,1,"li")(2,H,2,1,"li"),e&2){let _,n=t.$implicit;d((_=n.type)==="duplicate"?0:_==="undeclared"?1:_==="unused"?2:-1);}}function Q(e,t){if(e&1&&(o(0,"ul",9),U(1,J,3,1,null,null,O),l()),e&2){let _=r();a(),v(_.warnings);}}function Y(e,t){if(e&1&&(o(0,"div",10),y(1),l()),e&2){let _=r();a(),x(" ",_.error," ");}}function Z(e,t){if(e&1&&P(0,B,2,0,"div",7)(1,k,2,2,"div",8)(2,Q,3,0,"ul",9)(3,Y,2,1,"div",10),e&2){let _;d((_=t.type)==="pending"?0:_==="success"?1:_==="warnings"?2:3);}}var Ae=(()=>{class e{state=C(V);fb=C(K).nonNullable;rulesControl=this.fb.control(this.state.rules.raw.value());rulesText=L(this.rulesControl.valueChanges.pipe(I(this.rulesControl.value)));rulesPending=T(()=>this.rulesText()!==this.state.rules.raw.value());parserState=T(()=>this.rulesPending()?{type:"pending"}:this.state.rules.parsed.status()==="error"?{type:"error",error:z(this.state.rules.parsed.error())}:this.state.rules.parsed.value().warnings?.length?{type:"warnings",warnings:this.state.rules.parsed.value().warnings}:{type:"success",rules:this.state.rules.parsed.value().length});constructor(){let _=L(this.rulesControl.valueChanges.pipe($(500)));c(()=>{let n=_();typeof n=="string"&&n!==this.state.rules.raw.value()&&this.state.localRules.updateRules(n);}),c(()=>{this.state.rules.mode()==="local"?this.rulesControl.enable():this.rulesControl.disable();});}static ɵfac=function(n){return new(n||e)();};static ɵcmp=F({type:e,selectors:[["app-edit-rules-raw"]],hostAttrs:[1,"flex","grow","flex-col"],decls:3,vars:2,consts:()=>{let _;_="Rules as code";let n;n="Parser state";let A;A="pending";let R;R="success";let g;g="error";let p;p=" Waiting for input. ";let u;u="{VAR_PLURAL, plural, one {1 rule} other {{INTERPOLATION} rules}}",u=G(u,{INTERPOLATION:"\uFFFD1\uFFFD",VAR_PLURAL:"\uFFFD0\uFFFD"});let m;m=" Parsed "+u+" successfully! ";let N;N=" Variable "+"\uFFFD0\uFFFD"+" is declared more than once. ";let f;f=" Variable "+"\uFFFD0\uFFFD"+" is not declared in any question. ";let M;return M=" Variable "+"\uFFFD0\uFFFD"+" is not used in any condition. ",[p,m,N,f,M,["aria-label",_,1,"grow","resize-none","rounded-sm","border","border-gray-300","bg-gray-100","px-1","py-0","pb-8","font-mono","leading-tight","text-gray-700","focus:outline-hidden","dark:bg-gray-900","dark:text-gray-300",3,"formControl"],["aria-label",n,"aria-live","polite",1,"bg-active","bottom-0","p-2","font-mono"],["aria-label",A,1,"text-yellow-normal"],["aria-label",R,1,"text-green"],[1,"text-yellow-normal"],["aria-label",g,1,"text-red"]];},template:function(n,A){if(n&1&&(b(0,"textarea",5),o(1,"div",6),P(2,Z,4,1),l()),n&2){let R;W("formControl",A.rulesControl),a(2),d((R=A.parserState())?2:-1,R);}},dependencies:[X,h,w,D],encapsulation:2,changeDetection:0});}return e;})();export{Ae as EditRulesRawComponent};/**i18n:02aae89da1045ac2cdc4a3c2bd37bfe4ea4a29a6a927b3235b2a5699c115d91b*/