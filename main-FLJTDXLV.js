import{a as R}from"./chunk-AK7ZUWXN.js";import{a as Pe,b as y}from"./chunk-IE3IONSA.js";import{e as Ne,h as Oe}from"./chunk-QM4R6MNX.js";import{k as ke,o as a}from"./chunk-3632S4Y7.js";import{b as ye,f as q,g as Ce,j as Se,k as F,l as Te,m as Ae,n as Re,o as _e,p as xe,q as Ie}from"./chunk-FJK5ZZIC.js";import{$ as B,$a as de,$b as M,A as v,Aa as K,Ab as ve,B as l,Bb as we,G as h,Ha as ce,I as oe,N as ie,Q as p,S as w,Sa as ue,W as m,Ya as me,Z as ne,Zb as be,aa as n,ab as k,c as I,cb as Z,da as se,ec as Ee,g as Q,gc as D,ib as fe,ja as ae,k as ee,ka as le,l as P,m as te,nb as b,oa as O,ob as A,p as u,pb as E,rb as he,sa as pe,t as re,u as z,w as H,wb as ge,y as N,z as T}from"./chunk-E233IHIW.js";import"./chunk-LWVCSWLH.js";import{a as L}from"./chunk-OTVI3YWB.js";import{a as J}from"./chunk-7HGKORF3.js";function $e(r,e){if(r&1){let t=he();b(0,"div",8)(1,"button",9),ve("click",function(){ae(t);let i=we();return le(i.scrollTop());}),E(2,"app-icon-arrow-upward",6),A()();}}var U=class r{state=n(a);scrollTopVisible=Ee(()=>this.state.signal("scrollY")()>100);scrollTop(){window.scrollTo({top:0,behavior:"smooth"});}static ɵfac=function(t){return new(t||r)();};static ɵcmp=ue({type:r,selectors:[["app-root"]],decls:11,vars:1,consts:()=>{let e;e="application icon";let t;return t="TravelPacklist",[t,[1,"flex","h-[3rem]","flex-row","items-center","pb-2"],["routerLink","/",1,"flex","grow"],["alt",e,"src","icon.svg",1,"h-8"],[1,"text-xl","font-bold"],["routerLink","/config","routerLinkActive","hidden",1,"pr-2"],[1,"h-6","w-6"],[1,"flex","grow","flex-col","pb-[3.5rem]"],[1,"fixed","bottom-2","left-1/2","-translate-x-1/2"],["type","button",1,"flex","w-full","items-center","justify-center","rounded-3xl","border","border-slate-300","shadow-xl",3,"click"]];},template:function(t,o){t&1&&(b(0,"nav",1)(1,"a",2),E(2,"img",3),b(3,"span",4),ge(4,0),A()(),b(5,"a",5),E(6,"app-icon-cog",6),A()(),b(7,"div",7),E(8,"router-outlet"),me(9,$e,3,0,"div",8),A(),E(10,"app-dialog")),t&2&&(ce(9),fe(o.scrollTopVisible()?9:-1));},dependencies:[Ie,Se,Te,Ae,Oe,Pe,Ne],styles:["[_nghost-%COMP%]{display:flex;height:100%;flex-direction:column}"],changeDetection:0});};var x="Service workers are disabled or not supported by this browser";function Ge(r){return z(()=>te(new Error(r)));}var C=class{serviceWorker;worker;registration;events;constructor(e){if(this.serviceWorker=e,!e)this.worker=this.events=this.registration=Ge(x);else{let o=H(e,"controllerchange").pipe(u(()=>e.controller)),i=z(()=>P(e.controller)),c=re(i,o);this.worker=c.pipe(l(g=>!!g)),this.registration=this.worker.pipe(p(()=>e.getRegistration()));let S=H(e,"message").pipe(u(g=>g.data)).pipe(l(g=>g&&g.type)).pipe(ie());S.connect(),this.events=S;}}postMessage(e,t){return this.worker.pipe(h(1),w(o=>{o.postMessage(J({action:e},t));})).toPromise().then(()=>{});}postMessageWithOperation(e,t,o){let i=this.waitForOperationCompleted(o),c=this.postMessage(e,t);return Promise.all([c,i]).then(([,s])=>s);}generateNonce(){return Math.round(Math.random()*1e7);}eventsOfType(e){let t;return typeof e=="string"?t=o=>o.type===e:t=o=>e.includes(o.type),this.events.pipe(l(t));}nextEventOfType(e){return this.eventsOfType(e).pipe(h(1));}waitForOperationCompleted(e){return this.eventsOfType("OPERATION_COMPLETED").pipe(l(t=>t.nonce===e),h(1),u(t=>{if(t.result!==void 0)return t.result;throw new Error(t.error);})).toPromise();}get isEnabled(){return!!this.serviceWorker;}},ze=(()=>{class r{sw;messages;notificationClicks;subscription;get isEnabled(){return this.sw.isEnabled;}pushManager=null;subscriptionChanges=new Q();constructor(t){if(this.sw=t,!t.isEnabled){this.messages=v,this.notificationClicks=v,this.subscription=v;return;}this.messages=this.sw.eventsOfType("PUSH").pipe(u(i=>i.data)),this.notificationClicks=this.sw.eventsOfType("NOTIFICATION_CLICK").pipe(u(i=>i.data)),this.pushManager=this.sw.registration.pipe(u(i=>i.pushManager));let o=this.pushManager.pipe(p(i=>i.getSubscription()));this.subscription=T(o,this.subscriptionChanges);}requestSubscription(t){if(!this.sw.isEnabled||this.pushManager===null)return Promise.reject(new Error(x));let o={userVisibleOnly:!0},i=this.decodeBase64(t.serverPublicKey.replace(/_/g,"/").replace(/-/g,"+")),c=new Uint8Array(new ArrayBuffer(i.length));for(let s=0;s<i.length;s++)c[s]=i.charCodeAt(s);return o.applicationServerKey=c,this.pushManager.pipe(p(s=>s.subscribe(o)),h(1)).toPromise().then(s=>(this.subscriptionChanges.next(s),s));}unsubscribe(){if(!this.sw.isEnabled)return Promise.reject(new Error(x));let t=o=>{if(o===null)throw new Error("Not subscribed to push notifications.");return o.unsubscribe().then(i=>{if(!i)throw new Error("Unsubscribe failed!");this.subscriptionChanges.next(null);});};return this.subscription.pipe(h(1),p(t)).toPromise();}decodeBase64(t){return atob(t);}static ɵfac=function(o){return new(o||r)(B(C));};static ɵprov=m({token:r,factory:r.ɵfac});}return r;})(),X=(()=>{class r{sw;versionUpdates;unrecoverable;get isEnabled(){return this.sw.isEnabled;}constructor(t){if(this.sw=t,!t.isEnabled){this.versionUpdates=v,this.unrecoverable=v;return;}this.versionUpdates=this.sw.eventsOfType(["VERSION_DETECTED","VERSION_INSTALLATION_FAILED","VERSION_READY","NO_NEW_VERSION_DETECTED"]),this.unrecoverable=this.sw.eventsOfType("UNRECOVERABLE_STATE");}checkForUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(x));let t=this.sw.generateNonce();return this.sw.postMessageWithOperation("CHECK_FOR_UPDATES",{nonce:t},t);}activateUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(x));let t=this.sw.generateNonce();return this.sw.postMessageWithOperation("ACTIVATE_UPDATE",{nonce:t},t);}static ɵfac=function(o){return new(o||r)(B(C));};static ɵprov=m({token:r,factory:r.ɵfac});}return r;})();var Me=new ne("");function He(r,e,t,o){return()=>{if(!(q(o)&&"serviceWorker"in navigator&&t.enabled!==!1))return;let i=r.get(pe),c=r.get(Z);i.runOutsideAngular(()=>{let d=navigator.serviceWorker,f=()=>d.controller?.postMessage({action:"INITIALIZE"});d.addEventListener("controllerchange",f),c.onDestroy(()=>{d.removeEventListener("controllerchange",f);});});let s;if(typeof t.registrationStrategy=="function")s=t.registrationStrategy();else{let[d,...f]=(t.registrationStrategy||"registerWhenStable:30000").split(":");switch(d){case"registerImmediately":s=P(null);break;case"registerWithDelay":s=De(+f[0]||0);break;case"registerWhenStable":let S=ee(r.get(Z).whenStable());s=f[0]?T(S,De(+f[0])):S;break;default:throw new Error(`Unknown ServiceWorker registration strategy: ${t.registrationStrategy}`);}}i.runOutsideAngular(()=>s.pipe(h(1)).subscribe(()=>navigator.serviceWorker.register(e,{scope:t.scope}).catch(d=>console.error("Service worker registration failed with:",d))));};}function De(r){return P(null).pipe(oe(r));}function Be(r,e){return new C(q(e)&&r.enabled!==!1?navigator.serviceWorker:void 0);}var _=class{enabled;scope;registrationStrategy;};function Fe(r,e={}){return se([ze,X,{provide:Me,useValue:r},{provide:_,useValue:e},{provide:C,useFactory:Be,deps:[_,K]},{provide:de,useFactory:He,deps:[O,Me,_,K],multi:!0}]);}var Le=!1,Ue=async()=>{if(n(a).get("rulesContainComments")&&!Le){let e=await y("Die aktuellen Regeln enthalten Kommentare. Wenn du sie im grafischen Editor bearbeitest, werden diese Kommentare verworfen. M\xF6chtest du trotzdem fortfahren?");return e&&(Le=!0),e;}return!0;};var Y=()=>{let r=n(a),e=n(F),t=r.get("ruleParserError");return t?e.createUrlTree(["/rules-error"],{queryParams:{error:t}}):!0;};var je=[{path:"",redirectTo:"/packlist",pathMatch:"full"},{path:"packlist",loadComponent:()=>import("./chunk-DXO6XZSL.js"),canActivate:[Y]},{path:"config",loadComponent:()=>import("./chunk-WQYG53WL.js")},{path:"rules",loadComponent:()=>import("./chunk-I32HK2XQ.js"),canActivate:[Y,Ue]},{path:"rules-raw",loadComponent:()=>import("./chunk-TAO7YTHE.js")},{path:"rules-error",loadComponent:()=>import("./chunk-7YS5CUFX.js")},{path:"documentation",loadComponent:()=>import("./chunk-HHVG63WO.js")},{path:"**",redirectTo:"/packlist"}];var V=class r{injector=n(O);document=n(ye);init(){let e=this.injector.get(a),t=e.signal("theme");D(()=>{this.applyTheme(t());});let o=e.signal("preferredLanguage");D(()=>{this.applyLanguage(o());});let i=e.signal("fontSize");D(()=>{this.applyFontSize(i());});}applyTheme(e){let t=window.matchMedia("(prefers-color-scheme: dark)").matches;e==="system"&&t||e==="dark"?this.document.documentElement.classList.add("dark"):this.document.documentElement.classList.remove("dark");}applyLanguage(e){if(e&&this.document.documentElement.lang!==e){if(M()){console.warn("Language switching is disabled in dev mode");return;}let t=window.location.href,o=window.location.hash,i=`index${e==="en"?"":`.${e}`}.html`,s=t.substring(0,t.indexOf(o))+i+window.location.hash;setTimeout(()=>{window.location.href=s;},0);}}applyFontSize(e){document.documentElement.style.setProperty("--html-font-size",e==="small"?"16px":e==="normal"?"18px":"20px");}static ɵfac=function(t){return new(t||r)();};static ɵprov=m({token:r,factory:r.ɵfac,providedIn:"root"});};var W=class r{swUpdate=n(X);status=n(a).signal("serviceWorkerStatus");init(){T(this.swUpdate.versionUpdates,this.swUpdate.unrecoverable).pipe(w(e=>{if(e.type==="VERSION_INSTALLATION_FAILED")this.status.set("error"),console.error(`Version installation failed
`,e.error);else if(e.type==="NO_NEW_VERSION_DETECTED")this.status.set("ok");else if(e.type==="VERSION_READY"||e.type==="VERSION_DETECTED")this.status.set("update-available");else{let t=e;this.status.set("unrecoverable"),console.error(`Unrecoverable state
`,t.reason);}}),l(e=>e.type==="VERSION_READY"),p(()=>y("Eine neue Version der App ist verf\xFCgbar. M\xF6chtest du neu laden?")),l(I)).subscribe(()=>{window.location.reload();}),this.swUpdate.isEnabled?N(6e4).pipe(p(()=>this.swUpdate.checkForUpdate())).subscribe(e=>{e&&console.log("Update available");}):(this.status.set("disabled"),console.warn("Service worker updates are disabled/unavailable"));}static ɵfac=function(t){return new(t||r)();};static ɵprov=m({token:r,factory:r.ɵfac,providedIn:"root"});};var Ke=L("Filesystem",{web:()=>import("./chunk-BBZCYZH2.js").then(r=>new r.FilesystemWeb())});var Ze=L("Share",{web:()=>import("./chunk-ZXF43RIL.js").then(r=>new r.ShareWeb())});var $=class extends R{state=n(a);async webShareRules(){let e=this.state.get("rules");if(!e){console.error("No rules available");return;}let t=this.state.get("exportFileName");await navigator.share({title:t,files:[new File([e],t,{type:"text/plain"})]});}downloadRules(){let e=this.state.get("rules");if(!e){console.error("No rules available");return;}let t=new Blob([e],{type:"text/plain"}),o=URL.createObjectURL(t),i=document.createElement("a");i.href=o,i.download=this.state.get("exportFileName"),i.click();}async exportRules(){this.state.get("isMobile")&&"share"in navigator?await this.webShareRules():this.downloadRules();}};var G=class r{router=n(F);state=n(a);exportNeeded=this.state.signal("exportNeeded");reminderActive=this.state.signal("exportReminder");lastAskedHash=[];init(){N(3e4).pipe(l(()=>this.reminderActive()&&this.exportNeeded()&&this.exportOverdue()&&this.enoughTimeSinceLastEditPassed()),u(()=>this.state.get("rulesHash")),l(e=>!this.lastAskedHash.includes(e)),w(e=>{this.lastAskedHash.push(e);}),p(()=>y("Die aktuellen Regeln wurden seit einiger Zeit nicht mehr exportiert. M\xF6chtest du sie jetzt exportieren?")),l(I)).subscribe(()=>{this.router.navigate(["/config"],{fragment:"export-now"});});}exportOverdue(){let e=this.state.get("lastExportDate");return new Date().getTime()-e>Ve(10);}enoughTimeSinceLastEditPassed(){let e=this.state.get("lastRulesAction");return new Date().getTime()-e>Ve(2);}static ɵfac=function(t){return new(t||r)();};static ɵprov=m({token:r,factory:r.ɵfac,providedIn:"root"});};function Ve(r){return r*60*1e3;}function qe(r){return{isTrackWeight:r.signal("trackWeight")};}var We={providers:[be(),Re(je,_e(),xe()),Fe("ngsw-worker.js",{enabled:!M()&&!0,registrationStrategy:"registerImmediately"}),k(()=>{n(V).init();}),k(()=>{n(W).init();}),k(()=>{n(G).init();}),{provide:ke,useFactory:qe,deps:[a]},{provide:R,useClass:$}]};Ce(U,We).catch(r=>{console.error(r);});/**i18n:ce629f7757620cd455841d864165c42e946502d979ab9ef58d04496856a7546b*/