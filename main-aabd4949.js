import{a as C}from"./chunk-b9d41743.js";import{a as Ne,b as S}from"./chunk-46a04036.js";import{o as Ce,r as ye}from"./chunk-2fd21f29.js";import{m as Re,p as Ie,q as a}from"./chunk-d674646e.js";import{c as Ee,d as D,e as be,f as Se,g as ve,h as Pe,i as Te,j as Ae}from"./chunk-2cc4a044.js";import{b as Me}from"./chunk-1332e35c.js";import{$ as G,$a as pe,A as _,Aa as se,B as p,G as h,I as Q,Ka as ae,Lb as he,N as ee,Nb as x,Pa as le,Q as u,Qb as ge,S as w,Sa as ce,Sb as L,Ta as k,Va as K,Vb as _e,W as d,Z as te,aa as s,bc as z,c as I,da as re,dc as we,eb as E,fb as A,g as Z,gb as b,ia as oe,ib as ue,ja as ie,k as q,l as N,lb as me,m as Y,na as O,p as m,pb as de,qb as fe,ra as ne,t as J,u as $,va as W,w as j,y as M,z as T}from"./chunk-fa8487e3.js";import"./chunk-bc3446b7.js";import{a as F}from"./chunk-dd5b4548.js";import{a as B}from"./chunk-e13ede82.js";function Ke(t,o){if(t&1){let e=ue();E(0,"div",8)(1,"button",9),de("click",function(){oe(e);let i=fe();return ie(i.scrollTop());}),b(2,"app-icon-arrow-upward",6),A()();}}var Oe=(()=>{class t{state=s(a);scrollTopVisible=ge(()=>this.state.signal("scrollY")()>100);scrollTop(){window.scrollTo({top:0,behavior:"smooth"});}static ɵfac=function(r){return new(r||t)();};static ɵcmp=ae({type:t,selectors:[["app-root"]],decls:11,vars:1,consts:()=>{let e;e="Go to TravelPacklist";let r;r="application icon";let i;i="Go to configuration";let c;c="TravelPacklist";let n;return n="Scroll to top",[c,["role","navigation",1,"flex","h-[3rem]","min-h-[3rem]","flex-row","items-center","pb-2"],["aria-label",e,"role","banner","routerLink","/",1,"flex","h-full","grow","items-center"],["alt",r,"src","icon.svg",1,"h-8"],[1,"text-xl","font-bold"],["type","button","role","link","routerLink","/config","routerLinkActive","hidden","aria-label",i,1,"link","pr-2"],[1,"h-6","w-6"],[1,"flex","grow","flex-col","pb-[3.5rem]"],[1,"fixed","bottom-2","left-1/2","-translate-x-1/2"],["type","button","aria-label",n,1,"flex","w-full","items-center","justify-center","rounded-3xl","border","border-slate-300","shadow-xl",3,"click"]];},template:function(r,i){r&1&&(E(0,"nav",1)(1,"a",2),b(2,"img",3),E(3,"span",4),me(4,0),A()(),E(5,"button",5),b(6,"app-icon-cog",6),A()(),E(7,"div",7),b(8,"router-outlet"),le(9,Ke,3,0,"div",8),A(),b(10,"app-dialog")),r&2&&(se(9),pe(i.scrollTopVisible()?9:-1));},dependencies:[Ae,Ee,be,Se,Ce,Ne,ye],styles:["[_nghost-%COMP%]{display:flex;height:100%;flex-direction:column}"],changeDetection:0});}return t;})();var R="Service workers are disabled or not supported by this browser";function ze(t){return $(()=>Y(new Error(t)));}var v=class{serviceWorker;worker;registration;events;constructor(o){if(this.serviceWorker=o,!o)this.worker=this.events=this.registration=ze(R);else{let r=j(o,"controllerchange").pipe(m(()=>o.controller)),i=$(()=>N(o.controller)),c=J(i,r);this.worker=c.pipe(p(g=>!!g)),this.registration=this.worker.pipe(u(()=>o.getRegistration()));let P=j(o,"message").pipe(m(g=>g.data)).pipe(p(g=>g&&g.type)).pipe(ee());P.connect(),this.events=P;}}postMessage(o,e){return this.worker.pipe(h(1),w(r=>{r.postMessage(B({action:o},e));})).toPromise().then(()=>{});}postMessageWithOperation(o,e,r){let i=this.waitForOperationCompleted(r),c=this.postMessage(o,e);return Promise.all([c,i]).then(([,n])=>n);}generateNonce(){return Math.round(Math.random()*1e7);}eventsOfType(o){let e;return typeof o=="string"?e=r=>r.type===o:e=r=>o.includes(r.type),this.events.pipe(p(e));}nextEventOfType(o){return this.eventsOfType(o).pipe(h(1));}waitForOperationCompleted(o){return this.eventsOfType("OPERATION_COMPLETED").pipe(p(e=>e.nonce===o),h(1),m(e=>{if(e.result!==void 0)return e.result;throw new Error(e.error);})).toPromise();}get isEnabled(){return!!this.serviceWorker;}},Xe=(()=>{class t{sw;messages;notificationClicks;subscription;get isEnabled(){return this.sw.isEnabled;}pushManager=null;subscriptionChanges=new Z();constructor(e){if(this.sw=e,!e.isEnabled){this.messages=_,this.notificationClicks=_,this.subscription=_;return;}this.messages=this.sw.eventsOfType("PUSH").pipe(m(i=>i.data)),this.notificationClicks=this.sw.eventsOfType("NOTIFICATION_CLICK").pipe(m(i=>i.data)),this.pushManager=this.sw.registration.pipe(m(i=>i.pushManager));let r=this.pushManager.pipe(u(i=>i.getSubscription()));this.subscription=T(r,this.subscriptionChanges);}requestSubscription(e){if(!this.sw.isEnabled||this.pushManager===null)return Promise.reject(new Error(R));let r={userVisibleOnly:!0},i=this.decodeBase64(e.serverPublicKey.replace(/_/g,"/").replace(/-/g,"+")),c=new Uint8Array(new ArrayBuffer(i.length));for(let n=0;n<i.length;n++)c[n]=i.charCodeAt(n);return r.applicationServerKey=c,this.pushManager.pipe(u(n=>n.subscribe(r)),h(1)).toPromise().then(n=>(this.subscriptionChanges.next(n),n));}unsubscribe(){if(!this.sw.isEnabled)return Promise.reject(new Error(R));let e=r=>{if(r===null)throw new Error("Not subscribed to push notifications.");return r.unsubscribe().then(i=>{if(!i)throw new Error("Unsubscribe failed!");this.subscriptionChanges.next(null);});};return this.subscription.pipe(h(1),u(e)).toPromise();}decodeBase64(e){return atob(e);}static ɵfac=function(r){return new(r||t)(G(v));};static ɵprov=d({token:t,factory:t.ɵfac});}return t;})(),X=(()=>{class t{sw;versionUpdates;unrecoverable;get isEnabled(){return this.sw.isEnabled;}constructor(e){if(this.sw=e,!e.isEnabled){this.versionUpdates=_,this.unrecoverable=_;return;}this.versionUpdates=this.sw.eventsOfType(["VERSION_DETECTED","VERSION_INSTALLATION_FAILED","VERSION_READY","NO_NEW_VERSION_DETECTED"]),this.unrecoverable=this.sw.eventsOfType("UNRECOVERABLE_STATE");}checkForUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(R));let e=this.sw.generateNonce();return this.sw.postMessageWithOperation("CHECK_FOR_UPDATES",{nonce:e},e);}activateUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(R));let e=this.sw.generateNonce();return this.sw.postMessageWithOperation("ACTIVATE_UPDATE",{nonce:e},e);}static ɵfac=function(r){return new(r||t)(G(v));};static ɵprov=d({token:t,factory:t.ɵfac});}return t;})();var ke=new te("");function He(t,o,e,r){return()=>{if(!(z(r)&&"serviceWorker"in navigator&&e.enabled!==!1))return;let i=t.get(ne),c=t.get(K);i.runOutsideAngular(()=>{let l=navigator.serviceWorker,f=()=>l.controller?.postMessage({action:"INITIALIZE"});l.addEventListener("controllerchange",f),c.onDestroy(()=>{l.removeEventListener("controllerchange",f);});});let n;if(typeof e.registrationStrategy=="function")n=e.registrationStrategy();else{let[l,...f]=(e.registrationStrategy||"registerWhenStable:30000").split(":");switch(l){case"registerImmediately":n=N(null);break;case"registerWithDelay":n=xe(+f[0]||0);break;case"registerWhenStable":let P=q(t.get(K).whenStable());n=f[0]?T(P,xe(+f[0])):P;break;default:throw new Error(`Unknown ServiceWorker registration strategy: ${e.registrationStrategy}`);}}i.runOutsideAngular(()=>n.pipe(h(1)).subscribe(()=>navigator.serviceWorker.register(o,{scope:e.scope}).catch(l=>console.error("Service worker registration failed with:",l))));};}function xe(t){return N(null).pipe(Q(t));}function Be(t,o){return new v(z(o)&&t.enabled!==!1?navigator.serviceWorker:void 0);}var y=class{enabled;scope;registrationStrategy;};function Le(t,o={}){return re([Xe,X,{provide:ke,useValue:t},{provide:y,useValue:o},{provide:v,useFactory:Be,deps:[y,W]},{provide:ce,useFactory:He,deps:[O,ke,y,W],multi:!0}]);}var De=!1,Fe=async()=>{if(s(a).get("rulesContainComments")&&!De){let o=await S("The current rules contain comments. Editing them with the graphical editor will discard these comments. Do you want to proceed?");return o&&(De=!0),o;}return!0;};var H=()=>{let t=s(a),o=s(D),e=t.get("ruleParserError");return e?o.createUrlTree(["/rules-error"],{queryParams:{error:e}}):!0;};var Ue=[{path:"",redirectTo:"/packlist",pathMatch:"full"},{path:"packlist",loadComponent:()=>import("./chunk-28c7fcb2.js"),canActivate:[H]},{path:"config",loadComponent:()=>import("./chunk-79b0b99e.js")},{path:"rules",loadComponent:()=>import("./chunk-ba3e631b.js"),canActivate:[H,Fe]},{path:"rules-raw",loadComponent:()=>import("./chunk-d6b4fc64.js")},{path:"rules-error",loadComponent:()=>import("./chunk-0a067ca4.js")},{path:"documentation",loadComponent:()=>import("./chunk-a6dc4faf.js")},{path:"**",redirectTo:"/packlist"}];var Ve=(()=>{class t{state=s(a);document=s(_e);init(){let e=this.state.signal("theme");L(()=>{this.applyTheme(e());});let r=this.state.signal("preferredLanguage");L(()=>{this.applyLanguage(r());});let i=this.state.signal("fontSize");L(()=>{this.applyFontSize(i());});}applyTheme(e){let r=window.matchMedia("(prefers-color-scheme: dark)").matches;e==="system"&&r||e==="dark"?this.document.documentElement.classList.add("dark"):this.document.documentElement.classList.remove("dark");}applyLanguage(e){if(e&&this.document.documentElement.lang!==e){if(x()){console.warn("Language switching is disabled in dev mode");return;}let r=window.location.href,i=window.location.hash,c=`index${e==="en"?"":`.${e}`}.html`,l=r.substring(0,r.indexOf(i))+c+window.location.hash;setTimeout(()=>{window.location.href=l;},0);}}applyFontSize(e){document.documentElement.style.setProperty("--html-font-size",e==="small"?"16px":e==="normal"?"18px":"20px");}static ɵfac=function(r){return new(r||t)();};static ɵprov=d({token:t,factory:t.ɵfac,providedIn:"root"});}return t;})();var $e=(()=>{class t{swUpdate=s(X);status=s(a).signal("serviceWorkerStatus");init(){T(this.swUpdate.versionUpdates,this.swUpdate.unrecoverable).pipe(w(e=>{if(e.type==="VERSION_INSTALLATION_FAILED")this.status.set("error"),console.error(`Version installation failed
`,e.error);else if(e.type==="NO_NEW_VERSION_DETECTED")this.status.set("ok");else if(e.type==="VERSION_READY"||e.type==="VERSION_DETECTED")this.status.set("update-available");else{let r=e;this.status.set("unrecoverable"),console.error(`Unrecoverable state
`,r.reason);}}),p(e=>e.type==="VERSION_READY"),u(()=>S("A new version of the app is available. Do you want to reload?")),p(I)).subscribe(()=>{window.location.reload();}),this.swUpdate.isEnabled?M(6e4).pipe(u(()=>this.swUpdate.checkForUpdate())).subscribe(e=>{e&&console.log("Update available");}):(this.status.set("disabled"),console.warn("Service worker updates are disabled/unavailable"));}static ɵfac=function(r){return new(r||t)();};static ɵprov=d({token:t,factory:t.ɵfac,providedIn:"root"});}return t;})();var Ze=F("Filesystem",{web:()=>import("./chunk-03722084.js").then(t=>new t.FilesystemWeb())});var qe=F("Share",{web:()=>import("./chunk-40bafef5.js").then(t=>new t.ShareWeb())});var V=class extends C{state=s(a);async webShareRules(){let o=this.state.get("rules");if(!o){console.error("No rules available");return;}let e=this.state.get("exportFileName");await navigator.share({title:e,files:[new File([o],e,{type:"text/plain"})]});}downloadRules(){let o=this.state.get("rules");if(!o){console.error("No rules available");return;}let e=new Blob([o],{type:"text/plain"}),r=URL.createObjectURL(e),i=document.createElement("a");i.href=r,i.download=this.state.get("exportFileName"),i.click();}async exportRules(){this.state.get("isMobile")&&"share"in navigator?await this.webShareRules():this.downloadRules();}};var Ge=(()=>{class t{router=s(D);state=s(a);exportNeeded=this.state.signal("exportNeeded");reminderActive=this.state.signal("exportReminder");lastAskedHash=[];init(){M(3e4).pipe(p(()=>this.reminderActive()&&this.exportNeeded()&&this.exportOverdue()&&this.enoughTimeSinceLastEditPassed()),m(()=>this.state.get("rulesHash")),p(e=>!this.lastAskedHash.includes(e)),w(e=>{this.lastAskedHash.push(e);}),u(()=>S("The current rules haven't been exported for some time now. Do you want to export them now?")),p(I)).subscribe(()=>{this.router.navigate(["/config"],{fragment:"export-now"});});}exportOverdue(){let e=this.state.get("lastExportDate");return new Date().getTime()-e>je(10);}enoughTimeSinceLastEditPassed(){let e=this.state.get("lastRulesAction");return new Date().getTime()-e>je(2);}static ɵfac=function(r){return new(r||t)();};static ɵprov=d({token:t,factory:t.ɵfac,providedIn:"root"});}return t;})();function je(t){return t*60*1e3;}function Ye(t){return{isTrackWeight:()=>t.get(a).get("trackWeight")};}var We={providers:[he(),ve(Ue,Pe(),Te()),Le("ngsw-worker.js",{enabled:!x()&&!0,registrationStrategy:"registerImmediately"}),k(()=>{s(Ve).init();}),k(()=>{s($e).init();}),k(()=>{s(Ge).init();}),{deps:[O],provide:Re,useFactory:Ye},{provide:C,useClass:V},Me(),Ie()]};we(Oe,We).catch(t=>{console.error(t);});/**i18n:4b3ec942134fb294d3fa1293c03da3289f5b7f76404972cf87582f16ddb6b2ee*/