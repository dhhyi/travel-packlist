import{a as I}from"./chunk-RAQBVYOW.js";import{a as De}from"./chunk-H2SPHNQA.js";import{a as Me,b as y}from"./chunk-UESBYECV.js";import{a as L}from"./chunk-4TQKNQFE.js";import{j as ke,n as a}from"./chunk-ZZCNHYQV.js";import{b as Ae,f as Y,g as Ie,j as Re,k as j,l as _e,m as xe,n as Ne,o as Pe,p as Oe}from"./chunk-GVLRKNS6.js";import{$ as B,A as E,Aa as K,Ab as Ce,B as l,Bb as ye,G as v,Ha as fe,I as ne,N as se,Pa as M,Q as p,S as C,Va as he,W as u,Wa as D,Wb as Se,Ya as X,Yb as F,Z as ae,aa as n,bc as Te,c as N,cb as ge,da as le,g as te,hb as ve,ib as we,ja as pe,k as re,ka as ce,l as P,la as me,m as oe,nb as f,oa as k,ob as w,p as m,pb as h,rb as be,sa as ue,t as ie,u as H,va as de,w as Z,wb as Ee,y as O,z as A}from"./chunk-QP6SEBO3.js";import"./chunk-ODAM5CCI.js";import{a as U}from"./chunk-PHVZFTPN.js";import{a as ee}from"./chunk-XVUYO3C5.js";var J=()=>{let r=n(a),t=n(j),e=r.get("ruleParserError");return e?t.createUrlTree(["/rules-error"],{queryParams:{error:e}}):!0;};var Fe=!1,je=async()=>{if(n(a).get("rulesContainComments")&&!Fe){let t=await y("Die aktuellen Regeln enthalten Kommentare. Wenn du sie im grafischen Editor bearbeitest, werden diese Kommentare verworfen. M\xF6chtest du trotzdem fortfahren?");return t&&(Fe=!0),t;}return!0;};var Le=[{path:"",redirectTo:"/packlist",pathMatch:"full"},{path:"packlist",loadComponent:()=>import("./chunk-6AOZAIHE.js"),canActivate:[J]},{path:"config",loadComponent:()=>import("./chunk-HIFJ7YFR.js")},{path:"rules",loadComponent:()=>import("./chunk-HN55N7G2.js"),canActivate:[J,je]},{path:"rules-raw",loadComponent:()=>import("./chunk-XXJ6ZW2G.js")},{path:"rules-error",loadComponent:()=>import("./chunk-RLZVRVAJ.js")},{path:"documentation",loadComponent:()=>import("./chunk-3KAOH2G4.js")},{path:"**",redirectTo:"/packlist"}];var _="Service workers are disabled or not supported by this browser";function $e(r){return H(()=>oe(new Error(r)));}var S=class{serviceWorker;worker;registration;events;constructor(t){if(this.serviceWorker=t,!t)this.worker=this.events=this.registration=$e(_);else{let o=Z(t,"controllerchange").pipe(m(()=>t.controller)),i=H(()=>P(t.controller)),c=ie(i,o);this.worker=c.pipe(l(b=>!!b)),this.registration=this.worker.pipe(p(()=>t.getRegistration()));let T=Z(t,"message").pipe(m(b=>b.data)).pipe(l(b=>b&&b.type)).pipe(se());T.connect(),this.events=T;}}postMessage(t,e){return this.worker.pipe(v(1),C(o=>{o.postMessage(ee({action:t},e));})).toPromise().then(()=>{});}postMessageWithOperation(t,e,o){let i=this.waitForOperationCompleted(o),c=this.postMessage(t,e);return Promise.all([c,i]).then(([,s])=>s);}generateNonce(){return Math.round(Math.random()*1e7);}eventsOfType(t){let e;return typeof t=="string"?e=o=>o.type===t:e=o=>t.includes(o.type),this.events.pipe(l(e));}nextEventOfType(t){return this.eventsOfType(t).pipe(v(1));}waitForOperationCompleted(t){return this.eventsOfType("OPERATION_COMPLETED").pipe(l(e=>e.nonce===t),v(1),m(e=>{if(e.result!==void 0)return e.result;throw new Error(e.error);})).toPromise();}get isEnabled(){return!!this.serviceWorker;}},ze=(()=>{class r{sw;messages;notificationClicks;subscription;get isEnabled(){return this.sw.isEnabled;}pushManager=null;subscriptionChanges=new te();constructor(e){if(this.sw=e,!e.isEnabled){this.messages=E,this.notificationClicks=E,this.subscription=E;return;}this.messages=this.sw.eventsOfType("PUSH").pipe(m(i=>i.data)),this.notificationClicks=this.sw.eventsOfType("NOTIFICATION_CLICK").pipe(m(i=>i.data)),this.pushManager=this.sw.registration.pipe(m(i=>i.pushManager));let o=this.pushManager.pipe(p(i=>i.getSubscription()));this.subscription=A(o,this.subscriptionChanges);}requestSubscription(e){if(!this.sw.isEnabled||this.pushManager===null)return Promise.reject(new Error(_));let o={userVisibleOnly:!0},i=this.decodeBase64(e.serverPublicKey.replace(/_/g,"/").replace(/-/g,"+")),c=new Uint8Array(new ArrayBuffer(i.length));for(let s=0;s<i.length;s++)c[s]=i.charCodeAt(s);return o.applicationServerKey=c,this.pushManager.pipe(p(s=>s.subscribe(o)),v(1)).toPromise().then(s=>(this.subscriptionChanges.next(s),s));}unsubscribe(){if(!this.sw.isEnabled)return Promise.reject(new Error(_));let e=o=>{if(o===null)throw new Error("Not subscribed to push notifications.");return o.unsubscribe().then(i=>{if(!i)throw new Error("Unsubscribe failed!");this.subscriptionChanges.next(null);});};return this.subscription.pipe(v(1),p(e)).toPromise();}decodeBase64(e){return atob(e);}static ɵfac=function(o){return new(o||r)(B(S));};static ɵprov=u({token:r,factory:r.ɵfac});}return r;})(),Q=(()=>{class r{sw;versionUpdates;unrecoverable;get isEnabled(){return this.sw.isEnabled;}constructor(e){if(this.sw=e,!e.isEnabled){this.versionUpdates=E,this.unrecoverable=E;return;}this.versionUpdates=this.sw.eventsOfType(["VERSION_DETECTED","VERSION_INSTALLATION_FAILED","VERSION_READY","NO_NEW_VERSION_DETECTED"]),this.unrecoverable=this.sw.eventsOfType("UNRECOVERABLE_STATE");}checkForUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(_));let e=this.sw.generateNonce();return this.sw.postMessageWithOperation("CHECK_FOR_UPDATES",{nonce:e},e);}activateUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(_));let e=this.sw.generateNonce();return this.sw.postMessageWithOperation("ACTIVATE_UPDATE",{nonce:e},e);}static ɵfac=function(o){return new(o||r)(B(S));};static ɵprov=u({token:r,factory:r.ɵfac});}return r;})();var Ue=new ae("");function He(r,t,e,o){return()=>{if(!(Y(o)&&"serviceWorker"in navigator&&e.enabled!==!1))return;let i=r.get(ue),c=r.get(X);i.runOutsideAngular(()=>{let d=navigator.serviceWorker,g=()=>d.controller?.postMessage({action:"INITIALIZE"});d.addEventListener("controllerchange",g),c.onDestroy(()=>{d.removeEventListener("controllerchange",g);});});let s;if(typeof e.registrationStrategy=="function")s=e.registrationStrategy();else{let[d,...g]=(e.registrationStrategy||"registerWhenStable:30000").split(":");switch(d){case"registerImmediately":s=P(null);break;case"registerWithDelay":s=Ve(+g[0]||0);break;case"registerWhenStable":let T=re(r.get(X).whenStable());s=g[0]?A(T,Ve(+g[0])):T;break;default:throw new Error(`Unknown ServiceWorker registration strategy: ${e.registrationStrategy}`);}}i.runOutsideAngular(()=>s.pipe(v(1)).subscribe(()=>navigator.serviceWorker.register(t,{scope:e.scope}).catch(d=>console.error("Service worker registration failed with:",d))));};}function Ve(r){return P(null).pipe(ne(r));}function Ze(r,t){return new S(Y(t)&&r.enabled!==!1?navigator.serviceWorker:void 0);}var R=class{enabled;scope;registrationStrategy;};function qe(r,t={}){return le([ze,Q,{provide:Ue,useValue:r},{provide:R,useValue:t},{provide:S,useFactory:Ze,deps:[R,K]},{provide:he,useFactory:He,deps:[k,Ue,R,K],multi:!0}]);}var V=class r{injector=n(k);document=n(Ae);init(){let t=this.injector.get(a);L(t.signal("theme"),{injector:this.injector}).subscribe(e=>{this.applyTheme(e);}),L(t.signal("preferredLanguage"),{injector:this.injector}).subscribe(e=>{this.applyLanguage(e);}),L(t.signal("fontSize"),{injector:this.injector}).subscribe(e=>{this.applyFontSize(e);});}applyTheme(t){let e=window.matchMedia("(prefers-color-scheme: dark)").matches;t==="system"&&e||t==="dark"?this.document.documentElement.classList.add("dark"):this.document.documentElement.classList.remove("dark");}applyLanguage(t){if(t&&this.document.documentElement.lang!==t){if(F()){console.warn("Language switching is disabled in dev mode");return;}let e=window.location.href,o=window.location.hash,i=`index${t==="en"?"":`.${t}`}.html`,s=e.substring(0,e.indexOf(o))+i+window.location.hash;setTimeout(()=>{window.location.href=s;},0);}}applyFontSize(t){document.documentElement.style.setProperty("--html-font-size",t==="small"?"16px":t==="normal"?"18px":"20px");}static ɵfac=function(e){return new(e||r)();};static ɵprov=u({token:r,factory:r.ɵfac,providedIn:"root"});};var q=class r{swUpdate=n(Q);status=n(a).signal("serviceWorkerStatus");init(){A(this.swUpdate.versionUpdates,this.swUpdate.unrecoverable).pipe(C(t=>{if(t.type==="VERSION_INSTALLATION_FAILED")this.status.set("error"),console.error(`Version installation failed
`,t.error);else if(t.type==="NO_NEW_VERSION_DETECTED")this.status.set("ok");else if(t.type==="VERSION_READY"||t.type==="VERSION_DETECTED")this.status.set("update-available");else{let e=t;this.status.set("unrecoverable"),console.error(`Unrecoverable state
`,e.reason);}}),l(t=>t.type==="VERSION_READY"),p(()=>y("Eine neue Version der App ist verf\xFCgbar. M\xF6chtest du neu laden?")),l(N)).subscribe(()=>{window.location.reload();}),this.swUpdate.isEnabled?O(6e4).pipe(p(()=>this.swUpdate.checkForUpdate())).subscribe(t=>{t&&console.log("Update available");}):(this.status.set("disabled"),console.warn("Service worker updates are disabled/unavailable"));}static ɵfac=function(e){return new(e||r)();};static ɵprov=u({token:r,factory:r.ɵfac,providedIn:"root"});};var W=class r{router=n(j);state=n(a);exportNeeded=this.state.signal("exportNeeded");reminderActive=this.state.signal("exportReminder");lastAskedHash=[];init(){O(3e4).pipe(l(()=>this.reminderActive()&&this.exportNeeded()&&this.exportOverdue()&&this.enoughTimeSinceLastEditPassed()),m(()=>this.state.get("rulesHash")),l(t=>!this.lastAskedHash.includes(t)),C(t=>{this.lastAskedHash.push(t);}),p(()=>y("Die aktuellen Regeln wurden seit einiger Zeit nicht mehr exportiert. M\xF6chtest du sie jetzt exportieren?")),l(N)).subscribe(()=>{this.router.navigate(["/config"],{fragment:"export-now"});});}exportOverdue(){let t=this.state.get("lastExportDate");return new Date().getTime()-t>We(10);}enoughTimeSinceLastEditPassed(){let t=this.state.get("lastRulesAction");return new Date().getTime()-t>We(2);}static ɵfac=function(e){return new(e||r)();};static ɵprov=u({token:r,factory:r.ɵfac,providedIn:"root"});};function We(r){return r*60*1e3;}var Be=U("Filesystem",{web:()=>import("./chunk-4A3GQRXZ.js").then(r=>new r.FilesystemWeb())});var Ke=U("Share",{web:()=>import("./chunk-U7ZNJLG2.js").then(r=>new r.ShareWeb())});var G=class extends I{state=n(a);async webShareRules(){let t=this.state.get("rules");if(!t){console.error("No rules available");return;}let e=this.state.get("exportFileName");await navigator.share({title:e,files:[new File([t],e,{type:"text/plain"})]});}downloadRules(){let t=this.state.get("rules");if(!t){console.error("No rules available");return;}let e=new Blob([t],{type:"text/plain"}),o=URL.createObjectURL(e),i=document.createElement("a");i.href=o,i.download=this.state.get("exportFileName"),i.click();}async exportRules(){this.state.get("isMobile")&&"share"in navigator?await this.webShareRules():this.downloadRules();}};function Xe(r){return{isTrackWeight:r.signal("trackWeight")};}var Ge={providers:[Se(),xe(Le,Ne(),Pe()),qe("ngsw-worker.js",{enabled:!F()&&!0,registrationStrategy:"registerImmediately"}),D(()=>{n(V).init();}),D(()=>{n(q).init();}),D(()=>{n(W).init();}),{provide:ke,useFactory:Xe,deps:[a]},{provide:I,useClass:G}]};var $=class r{class=de("h-4 w-4");static ɵfac=function(e){return new(e||r)();};static ɵcmp=M({type:r,selectors:[["app-icon-cog"]],inputs:{class:[1,"class"]},decls:2,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","viewBox","0 -960 960 960"],["d","m370-80-16-128q-13-5-24.5-12T307-235l-119 50L78-375l103-78q-1-7-1-13.5v-27q0-6.5 1-13.5L78-585l110-190 119 50q11-8 23-15t24-12l16-128h220l16 128q13 5 24.5 12t22.5 15l119-50 110 190-103 78q1 7 1 13.5v27q0 6.5-2 13.5l103 78-110 190-118-50q-11 8-23 15t-24 12L590-80H370Zm70-80h79l14-106q31-8 57.5-23.5T639-327l99 41 39-68-86-65q5-14 7-29.5t2-31.5q0-16-2-31.5t-7-29.5l86-65-39-68-99 42q-22-23-48.5-38.5T533-694l-13-106h-79l-14 106q-31 8-57.5 23.5T321-633l-99-41-39 68 86 64q-5 15-7 30t-2 32q0 16 2 31t7 30l-86 65 39 68 99-42q22 23 48.5 38.5T427-266l13 106Zm42-180q58 0 99-41t41-99q0-58-41-99t-99-41q-59 0-99.5 41T342-480q0 58 40.5 99t99.5 41Zm-2-140Z"]],template:function(e,o){e&1&&(me(),f(0,"svg",0),h(1,"path",1),w()),e&2&&ve(o.class());},encapsulation:2,changeDetection:0});};function Je(r,t){if(r&1){let e=be();f(0,"div",8)(1,"button",9),Ce("click",function(){pe(e);let i=ye();return ce(i.scrollTop());}),h(2,"app-icon-up",6),w()();}}var z=class r{state=n(a);scrollTopVisible=Te(()=>this.state.signal("scrollY")()>100);scrollTop(){window.scrollTo({top:0,behavior:"smooth"});}static ɵfac=function(e){return new(e||r)();};static ɵcmp=M({type:r,selectors:[["app-root"]],decls:11,vars:1,consts:()=>{let t;t="application icon";let e;return e="TravelPacklist",[e,[1,"flex","h-12","flex-row","items-center","pb-2"],["routerLink","/",1,"flex","grow"],["alt",t,"src","icon.svg",1,"h-8"],[1,"text-2xl","font-bold"],["routerLink","/config",1,"pr-2"],[1,"h-6","w-6"],[1,"grow-children","flex","grow","flex-col"],[1,"sticky","bottom-2","flex","justify-center"],["type","button",1,"rounded-3xl","border","border-slate-300","shadow-xl",3,"click"]];},template:function(e,o){e&1&&(f(0,"nav",1)(1,"a",2),h(2,"img",3),f(3,"span",4),Ee(4,0),w()(),f(5,"a",5),h(6,"app-icon-cog",6),w()(),f(7,"div",7),h(8,"router-outlet"),ge(9,Je,3,0,"div",8),w(),h(10,"app-dialog")),e&2&&(fe(9),we(o.scrollTopVisible()?9:-1));},dependencies:[Oe,Re,_e,$,De,Me],encapsulation:2,changeDetection:0});};Ie(z,Ge).catch(r=>{console.error(r);});/**i18n:717214697a29241ab35fda4f803c9965e2e966609f94cbb4e7c0189a1847a6bb*/