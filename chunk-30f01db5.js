import{d as bt}from"./chunk-d99c5d68.js";import{c as $t,l as St,m as xe,n as Te,p as Ae}from"./chunk-4739b5be.js";import{$ as L,Ac as Re,C as we,Y as Ee,ca as b,da as mt,qc as ye,r as dt,wc as E,xc as F,ya as D,yc as Me,zc as vt}from"./chunk-cae6a0d4.js";import{a as ge,b as ht}from"./chunk-1b9a259e.js";function ns(s){return s.map(i=>i.toString()).map(i=>i+";").join(`

`);}function Oe(s,i,e=-1){if(!s)return"0g";let o=(e<0?s/1e3:(s/1e3).toFixed(e)).toString()+"kg",l=(s*1).toString()+"g";return i?i==="kg"?o:l:o.length<=l.length?o:l;}function is(s,i){return Oe(s,void 0,1)+" / "+Oe(i,void 0,1);}var B=class{condition;questions;items;constructor(i,e=[],o=[]){this.condition=i,this.questions=e,this.items=o;}toString(){let i=[];if(!(this.condition instanceof pe)){let o=this.condition.toString();o&&i.push(o," ");}i.push(":-");let e=this.questions.map(o=>o.toString()).concat(this.items.map(o=>o.toString()));if(e.length===1&&i.length===1)i.push(" ",e[0]);else for(let o=0;o<e.length;o++){let l=e[o];o>0&&i.push(","),i.push(`
`,"   ",l);}return i.join("");}},G=class{question;variable;static NEW_QUESTION_NAME="New Question";static NEW_VARIABLE_NAME="new_variable";constructor(i,e){this.question=i,this.variable=e;}toString(){return this.question+" $"+this.variable;}},ee=class{category;name;weight;static NEW_ITEM_NAME="New Item";static NEW_CATEGORY_NAME="New";constructor(i,e,o){this.category=i,this.name=e,this.weight=o;}toString(){let i=`[${this.category}] ${this.name}`.trim();return this.weight&&(i+=" "+Oe(this.weight)),i;}},z=class{variable;constructor(i){this.variable=i;}evaluate(i){return i[this.variable];}toString(){return this.variable;}},ls=(()=>{class s extends z{static string="please_select";constructor(){super(s.string);}}return s;})(),pe=(()=>{class s extends z{static string="always";constructor(){super(s.string);}evaluate(){return!0;}}return s;})(),K=class{not;constructor(i){this.not=i;}evaluate(i){return!this.not.evaluate(i);}toString(){return"NOT "+this.not.toString();}},Y=class{left;right;constructor(i,e){this.left=i,this.right=e;}evaluate(i){return this.left.evaluate(i)&&this.right.evaluate(i);}toString(){return this.left.toString()+" AND "+this.right.toString();}},J=class{left;right;constructor(i,e){this.left=i,this.right=e;}evaluate(i){return this.left.evaluate(i)||this.right.evaluate(i);}toString(){return this.left.toString()+" OR "+this.right.toString();}};function Wr(s,i){let e=i.filter(l=>l instanceof G),o=i.filter(l=>l instanceof ee);return new B(s??new pe(),e,o);}function wt(s){return s.length===1?s[0]:new Y(s[0],wt(s.slice(1)));}function Et(s){return s.length===1?s[0]:new J(s[0],Et(s.slice(1)));}function Pr(s,i){function e(){this.constructor=s;}e.prototype=i.prototype,s.prototype=new e();}function V(s,i,e,o){var l=Error.call(this,s);return Object.setPrototypeOf&&Object.setPrototypeOf(l,V.prototype),l.expected=i,l.found=e,l.location=o,l.name="SyntaxError",l;}Pr(V,Error);function Ue(s,i,e){return e=e||" ",s.length>i?s:(i-=s.length,e+=e.repeat(i),s+e.slice(0,i));}V.prototype.format=function(s){var i="Error: "+this.message;if(this.location){var e=null,o;for(o=0;o<s.length;o++)if(s[o].source===this.location.source){e=s[o].text.split(/\r\n|\n|\r/g);break;}var l=this.location.start,g=this.location.source&&typeof this.location.source.offset=="function"?this.location.source.offset(l):l,d=this.location.source+":"+g.line+":"+g.column;if(e){var x=this.location.end,N=Ue("",g.line.toString().length," "),$=e[l.line-1],v=l.line===x.line?x.column:$.length+1,T=v-l.column||1;i+=`
 --> `+d+`
`+N+` |
`+g.line+" | "+$+`
`+N+" | "+Ue("",l.column-1," ")+Ue("",T,"^");}else i+=`
 at `+d;}return i;};V.buildMessage=function(s,i){var e={literal:function($){return'"'+l($.text)+'"';},class:function($){var v=$.parts.map(function(T){return Array.isArray(T)?g(T[0])+"-"+g(T[1]):g(T);});return"["+($.inverted?"^":"")+v.join("")+"]";},any:function(){return"any character";},end:function(){return"end of input";},other:function($){return $.description;}};function o($){return $.charCodeAt(0).toString(16).toUpperCase();}function l($){return $.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(v){return"\\x0"+o(v);}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(v){return"\\x"+o(v);});}function g($){return $.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(v){return"\\x0"+o(v);}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(v){return"\\x"+o(v);});}function d($){return e[$.type]($);}function x($){var v=$.map(d),T,P;if(v.sort(),v.length>0){for(T=1,P=1;T<v.length;T++)v[T-1]!==v[T]&&(v[P]=v[T],P++);v.length=P;}switch(v.length){case 1:return v[0];case 2:return v[0]+" or "+v[1];default:return v.slice(0,-1).join(", ")+", or "+v[v.length-1];}}function N($){return $?'"'+l($)+'"':"end of input";}return"Expected "+x(s)+" but "+N(i)+" found.";};function M(s,i){i=i!==void 0?i:{};var e={},o=i.grammarSource,l={Rules:tt,Rule:Ce,Condition:st,Effects:at,Question:De,Item:Pe,VariableName:We,QuestionString:ot,ItemNameAndWeight:ct,CategoryName:lt},g=tt,d=";",x=":-",N="OR",$="AND",v="NOT",T=",",P="$",j="[",ae="]",Q="kg",te="g",re=".",se=/^[^$,;#]/,oe=/^[a-zA-Z]/,ne=/^[a-zA-Z0-9\-[\](){}_]/,w=/^[^\],;#[]/,X=/^[,;]/,m=/^[^ ,;#]/,S=/^[0-9]/,I=/^[ \t\n\r]/,k=C("rule end"),A=_(";",!1),le=C("rule"),ve=_(":-",!1),$e=C("condition"),Yt=_("OR",!1),Jt=_("AND",!1),Ie=_("NOT",!1),Zt=_(",",!1),Qe=C("question"),Xt=_("$",!1),qe=q(["$",",",";","#"],!0,!1),er=C("variable name"),tr=q([["a","z"],["A","Z"]],!1,!1),Be=q([["a","z"],["A","Z"],["0","9"],"-","[","]","(",")","{","}","_"],!1,!1),rr=C("item"),sr=C("category"),nr=_("[",!1),ir=_("]",!1),ar=C("category name"),Ke=q(["]",",",";","#","["],!0,!1),or=C("item name"),lr=C("word"),cr=q([",",";"],!1,!1),Ye=q([" ",",",";","#"],!0,!1),ur=C("weight"),fr=_("kg",!1),gr=_("g",!1),pr=C("number"),Se=q([["0","9"]],!1,!1),hr=_(".",!1),dr=C("whitespace"),Je=q([" ","	",`
`,"\r"],!1,!1),mr=Nr(),vr=function(t,r){return Wr(t,r);},$r=function(t){return Et(t);},Sr=function(t){return wt(t);},br=function(t){return new K(t);},wr=function(t){return new z(t);},Er=function(t,r){return new G(t.trim(),r.trim());},yr=function(t,r){let{name:a,weight:c}=r;return new ee(t.trim(),a,c);},Rr=function(t,r){return i.trackWeight;},xr=function(t,r){let a=t.trim();return a.length||Ze("item name"),{name:a,weight:r};},Tr=function(t){let r=t.trim();return r.length||Ze("item name"),{name:r,weight:void 0};},Ar=function(t){return t*1e3;},Or=function(){return parseFloat(kr());},n=i.peg$currPos|0,O=n,ie=[{line:1,column:1}],U=n,be=i.peg$maxFailExpected||[],u=i.peg$silentFails|0,ce;if(i.startRule){if(!(i.startRule in l))throw new Error(`Can't start parsing from rule "`+i.startRule+'".');g=l[i.startRule];}function kr(){return s.substring(O,n);}function es(){return O;}function ts(){return{source:o,start:O,end:n};}function rs(){return ue(O,n);}function Ze(t,r){throw r=r!==void 0?r:ue(O,n),et([C(t)],s.substring(O,n),r);}function ss(t,r){throw r=r!==void 0?r:ue(O,n),Cr(t,r);}function _(t,r){return{type:"literal",text:t,ignoreCase:r};}function q(t,r,a){return{type:"class",parts:t,inverted:r,ignoreCase:a};}function Nr(){return{type:"any"};}function Ir(){return{type:"end"};}function C(t){return{type:"other",description:t};}function Xe(t){var r=ie[t],a;if(r)return r;if(t>=ie.length)a=ie.length-1;else for(a=t;!ie[--a];);for(r=ie[a],r={line:r.line,column:r.column};a<t;)s.charCodeAt(a)===10?(r.line++,r.column=1):r.column++,a++;return ie[t]=r,r;}function ue(t,r,a){var c=Xe(t),f=Xe(r),h={source:o,start:{offset:t,line:c.line,column:c.column},end:{offset:r,line:f.line,column:f.column}};return a&&o&&typeof o.offset=="function"&&(h.start=o.offset(h.start),h.end=o.offset(h.end)),h;}function p(t){n<U||(n>U&&(U=n,be=[]),be.push(t));}function Cr(t,r){return new V(t,null,null,r);}function et(t,r,a){return new V(V.buildMessage(t,r),t,r,a);}function tt(){var t,r,a,c,f,h;for(t=n,r=y(),a=[],c=Ce();c!==e;)a.push(c),c=n,f=rt(),f!==e?(f=Ce(),f===e?(n=c,c=e):c=f):c=f;return c=rt(),c===e&&(c=null),f=y(),h=pt(),h!==e?t=a:(n=t,t=e),t;}function rt(){var t,r,a,c;return u++,t=n,r=y(),s.charCodeAt(n)===59?(a=d,n++):(a=e,u===0&&p(A)),a!==e?(c=y(),r=[r,a,c],t=r):(n=t,t=e),u--,t===e&&(r=e,u===0&&p(k)),t;}function Ce(){var t,r,a,c,f,h;return u++,t=n,r=st(),r===e&&(r=null),a=y(),s.substr(n,2)===x?(c=x,n+=2):(c=e,u===0&&p(ve)),c!==e?(f=y(),h=at(),O=t,t=vr(r,h)):(n=t,t=e),u--,t===e&&(r=e,u===0&&p(le)),t;}function st(){var t,r;return u++,t=Lr(),u--,t===e&&(r=e,u===0&&p($e)),t;}function Lr(){var t,r,a,c,f,h,R,fe;for(u++,t=n,r=n,a=[],c=nt();c!==e;)a.push(c),c=n,f=n,h=y(),s.substr(n,2)===N?(R=N,n+=2):(R=e,u===0&&p(Yt)),R!==e?(fe=y(),h=[h,R,fe],f=h):(n=f,f=e),f!==e?(f=nt(),f===e?(n=c,c=e):c=f):c=f;return a.length<1?(n=r,r=e):r=a,r!==e&&(O=t,r=$r(r)),t=r,u--,t===e&&(r=e,u===0&&p($e)),t;}function nt(){var t,r,a,c,f,h,R,fe;for(u++,t=n,r=n,a=[],c=Le();c!==e;)a.push(c),c=n,f=n,h=y(),s.substr(n,3)===$?(R=$,n+=3):(R=e,u===0&&p(Jt)),R!==e?(fe=y(),h=[h,R,fe],f=h):(n=f,f=e),f!==e?(f=Le(),f===e?(n=c,c=e):c=f):c=f;return a.length<1?(n=r,r=e):r=a,r!==e&&(O=t,r=Sr(r)),t=r,u--,t===e&&(r=e,u===0&&p($e)),t;}function Le(){var t,r,a,c,f,h;return u++,t=n,s.substr(n,3)===v?(r=v,n+=3):(r=e,u===0&&p(Ie)),r!==e?(a=y(),s.substr(n,3)===v?(c=v,n+=3):(c=e,u===0&&p(Ie)),c!==e?(f=y(),h=Le(),h!==e?t=h:(n=t,t=e)):(n=t,t=e)):(n=t,t=e),t===e&&(t=n,s.substr(n,3)===v?(r=v,n+=3):(r=e,u===0&&p(Ie)),r!==e?(a=y(),c=it(),c!==e?(O=t,t=br(c)):(n=t,t=e)):(n=t,t=e),t===e&&(t=n,r=it(),r!==e?t=r:(n=t,t=e))),u--,t===e&&(r=e,u===0&&p($e)),t;}function it(){var t,r;return t=n,r=We(),r!==e&&(O=t,r=wr(r)),t=r,t;}function at(){var t,r,a,c,f,h,R;for(t=n,r=[],a=De(),a===e&&(a=Pe());a!==e;)r.push(a),a=n,c=n,f=y(),s.charCodeAt(n)===44?(h=T,n++):(h=e,u===0&&p(Zt)),h!==e?(R=y(),f=[f,h,R],c=f):(n=c,c=e),c!==e?(c=De(),c===e&&(c=Pe()),c===e?(n=a,a=e):a=c):a=c;return t=r,t;}function De(){var t,r,a,c;return u++,t=n,r=ot(),r!==e?(s.charCodeAt(n)===36?(a=P,n++):(a=e,u===0&&p(Xt)),a!==e?(c=We(),c!==e?(O=t,t=Er(r,c)):(n=t,t=e)):(n=t,t=e)):(n=t,t=e),u--,t===e&&(r=e,u===0&&p(Qe)),t;}function ot(){var t,r,a;if(u++,t=n,r=[],a=s.charAt(n),se.test(a)?n++:(a=e,u===0&&p(qe)),a!==e)for(;a!==e;)r.push(a),a=s.charAt(n),se.test(a)?n++:(a=e,u===0&&p(qe));else r=e;return r!==e?t=s.substring(t,n):t=r,u--,t===e&&(r=e,u===0&&p(Qe)),t;}function We(){var t,r,a,c,f;if(u++,t=n,r=n,a=s.charAt(n),oe.test(a)?n++:(a=e,u===0&&p(tr)),a!==e){for(c=[],f=s.charAt(n),ne.test(f)?n++:(f=e,u===0&&p(Be));f!==e;)c.push(f),f=s.charAt(n),ne.test(f)?n++:(f=e,u===0&&p(Be));a=[a,c],r=a;}else n=r,r=e;return r!==e?t=s.substring(t,n):t=r,u--,t===e&&(r=e,u===0&&p(er)),t;}function Pe(){var t,r,a,c;return u++,t=n,r=Dr(),r!==e?(a=y(),c=ct(),c!==e?(O=t,t=yr(r,c)):(n=t,t=e)):(n=t,t=e),u--,t===e&&(r=e,u===0&&p(rr)),t;}function Dr(){var t,r,a,c,f,h;return u++,t=n,s.charCodeAt(n)===91?(r=j,n++):(r=e,u===0&&p(nr)),r!==e?(a=y(),c=lt(),c!==e?(f=y(),s.charCodeAt(n)===93?(h=ae,n++):(h=e,u===0&&p(ir)),h!==e?t=c:(n=t,t=e)):(n=t,t=e)):(n=t,t=e),u--,t===e&&(r=e,u===0&&p(sr)),t;}function lt(){var t,r,a;if(u++,t=n,r=[],a=s.charAt(n),w.test(a)?n++:(a=e,u===0&&p(Ke)),a!==e)for(;a!==e;)r.push(a),a=s.charAt(n),w.test(a)?n++:(a=e,u===0&&p(Ke));else r=e;return r!==e?t=s.substring(t,n):t=r,u--,t===e&&(r=e,u===0&&p(ar)),t;}function ct(){var t,r,a,c,f;for(u++,t=n,r=n,a=[],c=ut();c!==e;)a.push(c),c=n,f=y(),f=ut(),f===e?(n=c,c=e):c=f;if(r=s.substring(r,n),a=y(),c=ft(),c!==e?(O=n,f=Rr(r,c),f?f=void 0:f=e,f!==e?(O=t,t=xr(r,c)):(n=t,t=e)):(n=t,t=e),t===e){for(t=n,r=n,a=[],c=_e();c!==e;)a.push(c),c=n,f=y(),f=_e(),f===e?(n=c,c=e):c=f;r=s.substring(r,n),O=t,r=Tr(r),t=r;}return u--,t===e&&(r=e,u===0&&p(or)),t;}function ut(){var t,r,a,c,f,h;return u++,t=n,r=n,u++,a=n,c=ft(),c!==e?(f=y(),h=pt(),h===e&&(h=s.charAt(n),X.test(h)?n++:(h=e,u===0&&p(cr))),h!==e?(c=[c,f,h],a=c):(n=a,a=e)):(n=a,a=e),u--,a===e?r=void 0:(n=r,r=e),r!==e?(a=_e(),a!==e?t=a:(n=t,t=e)):(n=t,t=e),u--,t===e&&(r=e,u===0&&p(lr)),t;}function _e(){var t,r,a;if(t=n,r=[],a=s.charAt(n),m.test(a)?n++:(a=e,u===0&&p(Ye)),a!==e)for(;a!==e;)r.push(a),a=s.charAt(n),m.test(a)?n++:(a=e,u===0&&p(Ye));else r=e;return r!==e?t=s.substring(t,n):t=r,t;}function ft(){var t,r,a;return u++,t=n,r=gt(),r!==e?(s.substr(n,2)===Q?(a=Q,n+=2):(a=e,u===0&&p(fr)),a!==e?(O=t,t=Ar(r)):(n=t,t=e)):(n=t,t=e),t===e&&(t=n,r=gt(),r!==e?(s.charCodeAt(n)===103?(a=te,n++):(a=e,u===0&&p(gr)),a===e&&(a=null),t=r):(n=t,t=e)),u--,t===e&&(r=e,u===0&&p(ur)),t;}function gt(){var t,r,a,c,f,h,R;if(u++,t=n,r=[],a=s.charAt(n),S.test(a)?n++:(a=e,u===0&&p(Se)),a!==e)for(;a!==e;)r.push(a),a=s.charAt(n),S.test(a)?n++:(a=e,u===0&&p(Se));else r=e;if(r!==e){if(a=n,s.charCodeAt(n)===46?(c=re,n++):(c=e,u===0&&p(hr)),c!==e){if(f=n,h=[],R=s.charAt(n),S.test(R)?n++:(R=e,u===0&&p(Se)),R!==e)for(;R!==e;)h.push(R),R=s.charAt(n),S.test(R)?n++:(R=e,u===0&&p(Se));else h=e;h!==e?f=s.substring(f,n):f=h,f!==e?(c=[c,f],a=c):(n=a,a=e);}else n=a,a=e;a===e&&(a=null),O=t,t=Or();}else n=t,t=e;return u--,t===e&&(r=e,u===0&&p(pr)),t;}function y(){var t,r;for(u++,t=[],r=s.charAt(n),I.test(r)?n++:(r=e,u===0&&p(Je));r!==e;)t.push(r),r=s.charAt(n),I.test(r)?n++:(r=e,u===0&&p(Je));return u--,r=e,u===0&&p(dr),t;}function pt(){var t,r;return t=n,u++,s.length>n?(r=s.charAt(n),n++):(r=e,u===0&&p(mr)),u--,r===e?t=void 0:(n=t,t=e),t;}if(ce=g(),i.peg$library)return{peg$result:ce,peg$currPos:n,peg$FAILED:e,peg$maxFailExpected:be,peg$maxFailPos:U};if(ce!==e&&n===s.length)return ce;throw ce!==e&&n<s.length&&p(Ir()),et(be,U<s.length?s.charAt(U):null,U<s.length?ue(U,U+1):ue(U,U));}var Mr={isTrackWeight:()=>!1},Ur=new L("PARSER_CONFIG_PROVIDER"),ke=(()=>{class s{config=b(Ur,{optional:!0})??Mr;isTrackWeight(){return this.config.isTrackWeight();}makeOptions(e,o={}){return{startRule:e,trackWeight:o.forceWeightTracking??this.isTrackWeight()};}parseCondition(e){return M(e,this.makeOptions("Condition"));}parseQuestion(e){return M(e,this.makeOptions("Question"));}parseItem(e){return M(e,this.makeOptions("Item"));}parseEffects(e){return M(e,this.makeOptions("Effects"));}parseRule(e){return M(e,this.makeOptions("Rule"));}parseRules(e){let o=e.split(/\r?\n/g).map(l=>l.replace(/#.*/,"")).join(`
`);try{return M(o,this.makeOptions("Rules"));}catch(l){let g=[];if(g.push("Error parsing rules"),l instanceof V){let d=l.location.start.line.toString(),x=l.location.start.column.toString();g.push(" at line ",d," column ",x),g.push(":",`
`,l.message);}else l instanceof Error&&g.push(l.message);throw new Error(g.join(""));}}validateVariableName(e){M(e,this.makeOptions("VariableName"));}validateQuestionString(e){M(e,this.makeOptions("QuestionString"));}validateItemNameAndWeight(e){M(e,this.makeOptions("ItemNameAndWeight"));}validateCategoryName(e){M(e,this.makeOptions("CategoryName"));}forceParseWeight(e){return M(e,this.makeOptions("ItemNameAndWeight",{forceWeightTracking:!0})).weight??0;}static ɵfac=function(o){return new(o||s)();};static ɵprov=Ee({token:s,factory:s.ɵfac,providedIn:"root"});}return s;})();var je=(()=>{class s{parser=b(ke);extractVariables(e){return e.reduce((o,l)=>[...o,...l.questions.map(g=>g.variable)],[]);}extractCategories(e){let o=new Set();for(let l of e)for(let g of l.items)o.add(g.category);return Array.from(o);}renameVariable(e,o,l){if(l instanceof Array)return l.map(d=>this.renameVariable(e,o,d));if(l instanceof G)return l.variable===e?new G(l.question,o):l;if(l instanceof B)return new B(this.renameVariable(e,o,l.condition),l.questions.map(d=>this.renameVariable(e,o,d)),l.items);if(l instanceof z)return l.variable===e?new z(o):l;if(l instanceof K)return new K(this.renameVariable(e,o,l.not));if(l instanceof Y)return new Y(this.renameVariable(e,o,l.left),this.renameVariable(e,o,l.right));if(l instanceof J)return new J(this.renameVariable(e,o,l.left),this.renameVariable(e,o,l.right));let g=l;throw new Error("Unknown item type: "+g);}filterActive(e){let o=e.rules.filter(g=>g.condition.evaluate(e.model)),l=this.extractVariables(o).reduce((g,d)=>ht(ge({},g),{[d]:e.model[d]}),{[pe.string]:!0});return o.length===e.rules.length?{model:l,rules:o}:this.filterActive({model:l,rules:o});}contains(e,o){let l=o.toLowerCase();if(e instanceof B)return this.contains(e.condition,o)||e.questions.some(d=>this.contains(d,o))||e.items.some(d=>this.contains(d,o));if(e instanceof G)return e.question.toLowerCase().includes(l)||e.variable.toLowerCase().includes(l);if(e instanceof ee)return e.category.toLowerCase().includes(l)||e.name.toLowerCase().includes(l);if(e instanceof z)return e.variable.toLowerCase().includes(l);if(e instanceof K)return this.contains(e.not,o);if(e instanceof Y)return this.contains(e.left,o)||this.contains(e.right,o);if(e instanceof J)return this.contains(e.left,o)||this.contains(e.right,o);let g=e;throw new Error("Unknown item type: "+g);}countItemsAndWeights(e){return e.reduce((o,l)=>l.items.reduce((g,d)=>{let x;return this.parser.isTrackWeight()?x=d.weight?1:0:x=this.parser.forceParseWeight(d.name)?1:0,{items:g.items+1,weights:g.weights+x};},o),{items:0,weights:0});}static ɵfac=function(o){return new(o||s)();};static ɵprov=Ee({token:s,factory:s.ɵfac,providedIn:"root"});}return s;})();function jr(s,i){return Object.entries(s).concat(Object.entries(i)).reduce((e,[o,l])=>(e[o]=ge(ge({},e[o]),l),e),{});}var he=new L("RESET_SIGNAL",{providedIn:"root",factory:()=>D(!1)}),Ne=class s{state;triggerReset=b(he);constructor(i){this.state=i;}static builder(){return new s({});}extend(i){return new s(jr(this.state,i(this.state)));}build(){return this.state;}async reset(){this.triggerReset.set(Date.now()),await new Promise(i=>setTimeout(i,0));}};function Rt(s,i){if(typeof s!=typeof i)return!1;if(s&&i&&typeof s=="object"){let e=Object.keys(s),o=Object.keys(i);return e.length===o.length&&e.every(l=>Rt(s[l],i[l]));}return s===i;}function yt(s,i){let e=this.getItem("state")??"{}";return JSON.parse(e)[s]??i;}function Fr(s,i,e){let o=this.getItem("state")??"{}",l=JSON.parse(o);Rt(i,e)?delete l[s]:i===null?l[s]=void 0:l[s]=i,this.setItem("state",JSON.stringify(l));}function xt(s,i,e){let o=b(he),l=D(yt.call(s,i,e));return F(()=>{let g=l();g!==yt.call(s,i,e)&&Fr.call(s,i,g,e);},{manualCleanup:!0}),F(()=>{o()&&l.set(e);}),l;}var H=(s,i)=>xt(localStorage,s,i),de=(s,i)=>xt(sessionStorage,s,i);var W=H,Tt=["en","de"],At=()=>({config:{categorySorting:W("categorySorting","alphabetically"),trackWeight:W("trackWeight",!1),skipItems:W("skipItems",!1),fadeOutDisabledRules:W("fadeOutDisabledRules",!1),highlightVariableStatus:W("highlightVariableStatus",!1),refactorVariables:W("refactorVariables",!0),confirmRuleDeletion:W("confirmRuleDeletion",!0),rulesTemplate:W("rulesTemplate","default"),theme:W("theme","system"),fontSize:W("fontSize","normal"),accessibility:W("accessibility","accessible"),animations:W("animations",!0),language:W("language","auto"),exportReminder:W("exportReminder",!1)}});var Ot=({config:{language:s}})=>{let i=D(window.scrollY);return window.addEventListener("scroll",()=>{i.set(window.scrollY);}),{browser:{scrollY:i,isMobile:E(()=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|Mobile|mobile|CriOS/i.test(navigator.userAgent))},config:{preferredLanguage:E(()=>{let e=s();return e==="auto"?navigator.languages.map(g=>g.split("-")[0]).find(g=>Tt.includes(g))??"en":e;})}};};var kt=(s,i)=>de(s,i),Nt=()=>({clipboard:{items:kt("clipboardItems",[]),questions:kt("clipboardQuestions",[])}});var me=H;function Z(s){return`${s.category}-${s.name}`;}var It=({rules:{parsed:s},config:{categorySorting:i,skipItems:e}})=>{let o=me("answers",{}),l=me("checkedItems",[]),g=me("skippedItems",[]),d=me("collapsedCategories",[]),x=me("answersLocked",!1),N=de("statsVisible",void 0),$=de("askedWeightTracking",void 0),v=b(je),T=E(()=>v.filterActive({rules:s.value(),model:o()})),P=E(()=>T().rules),j=E(()=>P().flatMap(m=>m.items)),ae=E(()=>j().filter(m=>l().includes(Z(m)))),Q=m=>{l().includes(Z(m))?l.update(S=>S.filter(I=>I!==Z(m))):l.update(S=>[...S,Z(m)]);},te=E(()=>j().filter(m=>g().includes(Z(m)))),re=m=>{e()&&(g().includes(Z(m))?g.update(S=>S.filter(I=>I!==Z(m))):g.update(S=>[...S,Z(m)]));},se=m=>{d().includes(m)?d.update(S=>S.filter(I=>I!==m)):d.update(S=>[...S,m]);};function oe(m){return d().includes(m);}let ne=E(()=>i()==="definition"?()=>0:(S,I)=>S.localeCompare(I)),w=E(()=>{function m(k){return{name:k.category,items:[],totalItems:0,checkedItems:0,totalWeight:0,checkedWeight:0,collapsed:oe(k.category)};}let S=j().reduce((k,A)=>{k[A.category]||(k[A.category]=m(A));let le=e()&&te().includes(A),ve=!le&&ae().includes(A);return k[A.category].items.push({category:A.category,name:A.name,weight:A.weight,checked:ve,skipped:le}),ve&&(k[A.category].checkedItems++,k[A.category].checkedWeight+=A.weight??0),le||(k[A.category].totalItems++,k[A.category].totalWeight+=A.weight??0),k;},{}),I=ne();return Object.entries(S).map(k=>k[1]).toSorted((k,A)=>I(k.name,A.name));}),X=E(()=>Object.entries(w()).reduce((m,[,S])=>(m.totalItems+=S.totalItems,m.checkedItems+=S.checkedItems,m.totalWeight+=S.totalWeight,m.checkedWeight+=S.checkedWeight,m),{totalItems:0,checkedItems:0,totalWeight:0,checkedWeight:0}));return F(()=>{s.value(),x.set(!1),N.set(void 0);}),{rules:{categories:E(()=>v.extractCategories(s.value())),variables:E(()=>v.extractVariables(s.value()))},active:{rules:P,answers:E(()=>T().model),questions:E(()=>P().flatMap(m=>m.questions))},packlist:{answers:o,model:w,stats:X,toggleCheckedItem:Q,toggleSkippedItem:re,toggleCategoryCollapse:se,answersLocked:x,statsVisible:N,askedWeightTracking:$,reset:()=>{o.set({}),l.set([]),g.set([]),d.set([]),x.set(!1),N.set(void 0);}}};};var Fe=(s,i)=>{let e=b(Ae),o=b(Te),l=b(he),g=D(void 0);return e.events.pipe(we(d=>d instanceof xe),dt(()=>o.snapshot.queryParams[s]??i)).subscribe(d=>{d!==""&&g.set(d);}),F(()=>{let d=g()||void 0;d===i&&(d=void 0),o.snapshot.queryParams[s]!==d&&e.navigate([],{queryParams:{[s]:d},queryParamsHandling:"merge",relativeTo:o,replaceUrl:!0});}),F(()=>{l()&&g.set(i);}),g;};var zr={back(){window.history.back();},packlist(){this.router.navigate(["/packlist"]);},rules(){this.router.navigate(["/rules"]);},"rules-documentation"(){this.router.navigateByUrl("/documentation/rules");},"remote-rules-documentation"(){this.router.navigateByUrl("/documentation/remote-rules");},"rules-raw"(){this.router.navigate(["/rules-raw"]);},"rules->edit"(){this.router.navigate(["/rules"]).then(()=>{this.rulesMode.set("edit");});},config(){this.router.navigate(["/config"]);},"config#import"(){this.router.navigate(["/config"],{fragment:"import"});},"config#export"(){this.router.navigate(["/config"],{fragment:"export-now"});}},Ct=()=>{let s=b(Ae),i=b(Te),e=Fe("rulesMode","view"),o=b($t),l=D(o.path());return s.events.pipe(we(g=>g instanceof xe)).subscribe(()=>{o.path()!==l()&&l.set(o.path());}),{router:{rulesMode:e,filterRulesQuery:Fe("filterRulesQuery",void 0),path:l.asReadonly(),fragment:St(i.fragment),go:g=>{zr[g].call({router:s,rulesMode:e});}}};};var Lt=({config:{trackWeight:s},rules:{raw:i}})=>{let e=b(ke),o=Re({request:()=>(s(),i.value()),loader:({request:l})=>Promise.resolve(l?e.parseRules(l):[]),defaultValue:[]});return{rules:{parsed:o,hasError:E(()=>o.status()===Me.Error||i.status()===Me.Error),isLoading:E(()=>o.isLoading()||i.isLoading())}};};var Dt=/https:\/\/gist\.github\.com\/([^/]+)\/([a-z0-9]{32})(#file-)?([\w-]+)?/,Wt={name:"GitHub Gist",test:s=>Dt.test(s),transform:s=>{let i=Dt.exec(s);if(!i)return s;let[,e,o,,l]=i;return l?`https://gist.githubusercontent.com/${e}/${o}/raw/${l}`:`https://gist.githubusercontent.com/${e}/${o}/raw`;}};var ze=class{name="GitHub";test(i){return i.startsWith("https://github.com/");}transform(i){return i.replace("https://github.com/","https://raw.githubusercontent.com/").replace("/blob/","/");}},Pt=new ze();var _t=/https:\/\/drive\.google\.com\/file\/d\/([^/]+)(?:\/.*)?/,Vr={name:"Google Drive",needsCORS:!0,test:s=>_t.test(s),transform:s=>{let i=_t.exec(s);return i?`https://drive.google.com/uc?export=download&id=${i[1]}`:s;}},Mt=Vr;var Hr={name:"Pastebin",needsCORS:!0,test:s=>s.startsWith("https://pastebin.com/")&&!s.includes("/raw/"),transform:s=>s.replace("https://pastebin.com/","https://pastebin.com/raw/")},Ut=Hr;var Gr=[Wt,Pt,Mt,Ut];function jt(s,i){if(s){let e=Gr.find(o=>o.test(s));if(e){let o=e.transform(s);return i&&e.needsCORS?"https://api.allorigins.win/raw?url="+encodeURIComponent(o):o;}}return s;}var Ft=`:-
   [N\xFCtzliches] Papiertaschent\xFCcher,
   [N\xFCtzliches] Rucksack;

:- Reist du l\xE4nger als 3 Tage? $longer;

longer :-
   Hast du eine Waschmaschine oder einen W\xE4scheservice zur Verf\xFCgung? $laundry,
   Willst du arbeiten? $work,
   [Elektronik] Handy-Ladeger\xE4t,
   [Elektronik] Tablet;

longer AND NOT laundry :-
   [Kleidung] genug Hemden,
   [Kleidung] genug Unterw\xE4sche,
   [Kleidung] Ersatzhosen;

laundry :-
   [Kleidung] 3 Hemden,
   [Kleidung] 3 S\xE4tze Unterw\xE4sche;

work :-
   [Elektronik] Laptop;

:-
   Wird es sonnig sein? $sunny,
   Wird es regnerisch sein? $rainy,
   Reist du ins Ausland? $abroad;

sunny :-
   Erwartest du einen hohen UV-Index? $uv,
   [N\xFCtzliches] Sonnenbrille,
   [Kleidung] Kurze Hosen;

rainy :-
   [Kleidung] Regenjacke;

NOT rainy :-
   [Kleidung] Jacke;

NOT sunny :-
   [Kleidung] Lange Hosen;

uv :-
   [N\xFCtzliches] Sonnencreme;

abroad :-
   [Dokumente] Reisepass,
   [Dokumente] Visum;
`;var zt=`:-
   [Utility] Paper Tissues,
   [Utility] Backpack;

:- Are you traveling longer than 3 days? $longer;

longer :-
   Do you have a washer or laundry service available? $laundry,
   Do you want to work? $work,
   [Electronics] Phone Charger,
   [Electronics] Tablet;

longer AND NOT laundry :-
   [Clothes] enough Shirts,
   [Clothes] enough Underwear,
   [Clothes] spare Pants;

laundry :-
   [Clothes] 3 Shirts,
   [Clothes] 3 sets of Underwear;

work :-
   [Electronics] Laptop;

:-
   Will it be sunny? $sunny,
   Will it be rainy? $rainy,
   Are you traveling abroad? $abroad;

sunny :-
   Do you expect a high UV index? $uv,
   [Utility] Sunglasses,
   [Clothes] Short Pants;

rainy :-
   [Clothes] Rain Jacket;

NOT rainy :-
   [Clothes] Jacket;

NOT sunny :-
   [Clothes] Long Pants;

uv :-
   [Utility] Sunscreen;

abroad :-
   [Documents] Passport,
   [Documents] Visa;
`;var Vt=`:- [Neu] Dies ist dein erster Gegenstand;
`;var Ht=`:- [New] This is your first item;
`;var Gt=`:-
   a $a,
   b $b,
   c $c;

a :-
   [rules] 1: a;

NOT a :-
   [rules] 2: NOT a;

a AND b :-
   [rules] 3: a AND b;

NOT a AND b :-
   [rules] 4: NOT a AND b;

NOT a AND NOT b :-
   [rules] 5: NOT a AND NOT b;

a OR c :-
   [rules] 6: a OR c;

a OR NOT c :-
   [rules] 7: a OR NOT c;

NOT a OR NOT c :-
   [rules] 8: NOT a OR NOT c;

a AND b OR c :-
   [rules] 9: a AND b OR c;

NOT a AND b OR NOT c :-
   [rules] 10: NOT a AND b OR NOT c;

NOT a AND b OR NOT c AND a OR NOT b AND c :-
   [rules] 11: NOT a AND b OR NOT c AND a OR NOT b AND c;
`;var Ve=new L("DEFAULT_RULES_TEMPLATE");function Qr(s){return s.startsWith("de")?Ft:zt;}var He=new L("EMPTY_RULES_TEMPLATE");function qr(s){return s.startsWith("de")?Vt:Ht;}var Ge=new L("LOGIC_RULES_TEMPLATE");function Br(){return Gt;}function kn(){return mt([{provide:Ve,useFactory:Qr,deps:[ye]},{provide:He,useFactory:qr,deps:[ye]},{provide:Ge,useFactory:Br,deps:[ye]}]);}var Qt=new L("CAPACITOR_HTTP_REQUEST_MODE");function Kr(s){switch(s){case 400:return"Bad Request";case 401:return"Unauthorized";case 403:return"Forbidden";case 404:return"Not Found";case 500:return"Internal Server Error";case 504:return"Gateway Timeout";default:return;}}var qt=({config:{rulesTemplate:s}})=>{let i=H("rulesMode","template"),e=H("rules",void 0),o=E(()=>e()!==void 0),l=E(()=>{let w=e();if(w)return Yr(w).toString(16);}),g=H("lastExportHash",void 0),d=H("lastExportDate",void 0),x=()=>{g.set(l()),d.set(new Date().getTime());},N=D(new Date().getTime());F(()=>{e(),N.set(new Date().getTime());});let $=b(Ve),v=b(He),T=b(Ge),P=E(()=>{switch(s()){case"empty":return v;case"logic":return T;default:return $;}}),j=H("remoteHistory",[]),ae=function(w){j.update(X=>X.filter(m=>m!==w));},Q=vt(()=>i()==="remote"?j()[0]:void 0),te=b(Qt,{optional:!0})??"cors",re=Re({request:()=>({mode:i(),rawLocal:e(),remote:Q(),template:P()}),loader:({request:w})=>{switch(w.mode){case"local":return Promise.resolve(w.rawLocal);case"template":return Promise.resolve(w.template);case"remote":if(w.remote){if(!w.remote.startsWith("http"))throw new Error("Invalid URL");let X=jt(w.remote,te==="cors");return bt.get({url:X,webFetchExtra:{mode:te}}).then(m=>{if(m.status>=200&&m.status<300)return j.update(S=>[w.remote,...S.filter(I=>I!==w.remote)]),m.data;{let S=[["HTTP Error",m.status.toString()].join(" "),Kr(m.status)].join(": ");throw new Error(S);}});}else return Promise.resolve(void 0);}}}),se=function(w){Q()!==w&&(i.set("remote"),Q.set(w));},oe=function(w){i.set("local"),e.set(w);},ne=function(){e.set(re.value()),i.set("local"),x();};return{rules:{mode:i,raw:re.asReadonly(),lastAction:N.asReadonly(),hash:l,exportNeeded:E(()=>i()==="local"&&l()!==g()),markAsCurrent:x,localRulesAvailable:o},export:{lastDate:d.asReadonly()},localRules:{updateRules:oe,copyFromCurrent:ne},remoteRules:{load:se,history:j.asReadonly(),removeFromHistory:ae}};},Yr=function(s,i=0){let e=3735928559^i,o=1103547991^i;for(let l=0,g;l<s.length;l++)g=s.charCodeAt(l),e=Math.imul(e^g,2654435761),o=Math.imul(o^g,1597334677);return e=Math.imul(e^e>>>16,2246822507),e^=Math.imul(o^o>>>13,3266489909),o=Math.imul(o^o>>>16,2246822507),o^=Math.imul(e^e>>>13,3266489909),4294967296*(2097151&o)+(e>>>0);};var Bt=()=>({serviceWorker:{status:D("init")}});function Jr(){return Ne.builder().extend(Ct).extend(Nt).extend(Bt).extend(At).extend(Ot).extend(qt).extend(Lt).extend(It);}var Kt=new L("STATE_BUILDER",{providedIn:"root",factory:()=>Jr()}),Zr=new L("GLOBAL_STATE",{providedIn:"root",factory:()=>b(Kt).build()}),Xr=new L("RESET_SWITCH",{providedIn:"root",factory:()=>{let s=b(Kt);return async()=>{await s.reset();};}});export{ns as a,Oe as b,is as c,B as d,G as e,ee as f,z as g,ls as h,pe as i,K as j,Y as k,J as l,V as m,Ur as n,ke as o,je as p,kn as q,Qt as r,Zr as s,Xr as t};/**i18n:23f0d14f3ae719cb1264510a102962ddde538b134ce7f5438660b98bca748f67*/