import{a as st,b as nt,d as it}from"./chunk-e15b0d87.js";import{$b as O,B as et,Ga as A,Vb as rt,W as k,Z as q,Zb as y,aa as b,da as tt,p as Xe}from"./chunk-e83faf22.js";import{a as E,b as se}from"./chunk-71f6c2da.js";function fr(n){return n.map(l=>l.toString()).map(l=>l+";").join(`

`);}function me(n,l,e=-1){if(!n)return"0g";let a=(e<0?n/1e3:(n/1e3).toFixed(e)).toString()+"kg",c=(n*1).toString()+"g";return l?l==="kg"?a:c:a.length<=c.length?a:c;}var F=class{condition;questions;items;constructor(l,e=[],a=[]){this.condition=l,this.questions=e,this.items=a;}toString(){let l=[];if(!(this.condition instanceof G)){let a=this.condition.toString();a&&l.push(a," ");}l.push(":-");let e=this.questions.map(a=>a.toString()).concat(this.items.map(a=>a.toString()));if(e.length===1&&l.length===1)l.push(" ",e[0]);else for(let a=0;a<e.length;a++){let c=e[a];a>0&&l.push(","),l.push(`
`,"   ",c);}return l.join("");}},L=class{question;variable;static NEW_QUESTION_NAME="New Question";static NEW_VARIABLE_NAME="new_variable";constructor(l,e){this.question=l,this.variable=e;}toString(){return this.question+" $"+this.variable;}},U=class{category;name;weight;static NEW_ITEM_NAME="New Item";static NEW_CATEGORY_NAME="New";constructor(l,e,a){this.category=l,this.name=e,this.weight=a;}toString(){let l=`[${this.category}] ${this.name}`.trim();return this.weight&&(l+=" "+me(this.weight)),l;}},N=class{variable;constructor(l){this.variable=l;}evaluate(l){return l[this.variable];}toString(){return this.variable;}},Ir=(()=>{class n extends N{static string="please_select";constructor(){super(n.string);}}return n;})(),G=(()=>{class n extends N{static string="always";constructor(){super(n.string);}evaluate(){return!0;}}return n;})(),D=class{not;constructor(l){this.not=l;}evaluate(l){return!this.not.evaluate(l);}toString(){return"NOT "+this.not.toString();}},M=class{left;right;constructor(l,e){this.left=l,this.right=e;}evaluate(l){return this.left.evaluate(l)&&this.right.evaluate(l);}toString(){return this.left.toString()+" AND "+this.right.toString();}},z=class{left;right;constructor(l,e){this.left=l,this.right=e;}evaluate(l){return this.left.evaluate(l)||this.right.evaluate(l);}toString(){return this.left.toString()+" OR "+this.right.toString();}};function ur(n,l){let e=l.filter(c=>c instanceof L),a=l.filter(c=>c instanceof U);return new F(n??new G(),e,a);}function at(n){return n.length===1?n[0]:new M(n[0],at(n.slice(1)));}function ot(n){return n.length===1?n[0]:new z(n[0],ot(n.slice(1)));}function gr(n,l){function e(){this.constructor=n;}e.prototype=l.prototype,n.prototype=new e();}function j(n,l,e,a){var c=Error.call(this,n);return Object.setPrototypeOf&&Object.setPrototypeOf(c,j.prototype),c.expected=l,c.found=e,c.location=a,c.name="SyntaxError",c;}gr(j,Error);function ve(n,l,e){return e=e||" ",n.length>l?n:(l-=n.length,e+=e.repeat(l),n+e.slice(0,l));}j.prototype.format=function(n){var l="Error: "+this.message;if(this.location){var e=null,a;for(a=0;a<n.length;a++)if(n[a].source===this.location.source){e=n[a].text.split(/\r\n|\n|\r/g);break;}var c=this.location.start,g=this.location.source&&typeof this.location.source.offset=="function"?this.location.source.offset(c):c,d=this.location.source+":"+g.line+":"+g.column;if(e){var x=this.location.end,R=ve("",g.line.toString().length," "),v=e[c.line-1],m=c.line===x.line?x.column:v.length+1,I=m-c.column||1;l+=`
 --> `+d+`
`+R+` |
`+g.line+" | "+v+`
`+R+" | "+ve("",c.column-1," ")+ve("",I,"^");}else l+=`
 at `+d;}return l;};j.buildMessage=function(n,l){var e={literal:function(v){return'"'+c(v.text)+'"';},class:function(v){var m=v.parts.map(function(I){return Array.isArray(I)?g(I[0])+"-"+g(I[1]):g(I);});return"["+(v.inverted?"^":"")+m.join("")+"]";},any:function(){return"any character";},end:function(){return"end of input";},other:function(v){return v.description;}};function a(v){return v.charCodeAt(0).toString(16).toUpperCase();}function c(v){return v.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(m){return"\\x0"+a(m);}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(m){return"\\x"+a(m);});}function g(v){return v.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(m){return"\\x0"+a(m);}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(m){return"\\x"+a(m);});}function d(v){return e[v.type](v);}function x(v){var m=v.map(d),I,Q;if(m.sort(),m.length>0){for(I=1,Q=1;I<m.length;I++)m[I-1]!==m[I]&&(m[Q]=m[I],Q++);m.length=Q;}switch(m.length){case 1:return m[0];case 2:return m[0]+" or "+m[1];default:return m.slice(0,-1).join(", ")+", or "+m[m.length-1];}}function R(v){return v?'"'+c(v)+'"':"end of input";}return"Expected "+x(n)+" but "+R(l)+" found.";};function W(n,l){l=l!==void 0?l:{};var e={},a=l.grammarSource,c={Rules:Me,Rule:fe,Condition:qe,Effects:He,Question:ge,Item:he,VariableName:pe,QuestionString:Ke,ItemNameAndWeight:Be,CategoryName:_e},g=Me,d=";",x=":-",R="OR",v="AND",m="NOT",I=",",Q="$",dt="[",mt="]",Ae="kg",vt="g",$t=".",Re=/^[^$,;#]/,wt=/^[a-zA-Z]/,Ie=/^[a-zA-Z0-9\-[\](){}_]/,Ce=/^[^\],;#[]/,bt=/^[,;]/,Oe=/^[^ ,;#]/,X=/^[0-9]/,Te=/^[ \t\n\r]/,St=C("rule end"),yt=T(";",!1),xt=C("rule"),Et=T(":-",!1),ee=C("condition"),At=T("OR",!1),Rt=T("AND",!1),ce=T("NOT",!1),It=T(",",!1),ke=C("question"),Ct=T("$",!1),We=V(["$",",",";","#"],!0,!1),Ot=C("variable name"),Tt=V([["a","z"],["A","Z"]],!1,!1),Pe=V([["a","z"],["A","Z"],["0","9"],"-","[","]","(",")","{","}","_"],!1,!1),kt=C("item"),Wt=C("category"),Pt=T("[",!1),Nt=T("]",!1),jt=C("category name"),Ne=V(["]",",",";","#","["],!0,!1),Lt=C("item name"),Vt=C("word"),Ft=V([",",";"],!1,!1),je=V([" ",",",";","#"],!0,!1),Dt=C("weight"),Mt=T("kg",!1),zt=T("g",!1),qt=C("number"),te=V([["0","9"]],!1,!1),Ut=T(".",!1),Qt=C("whitespace"),Le=V([" ","	",`
`,"\r"],!1,!1),Ht=ir(),Kt=function(t,r){return ur(t,r);},_t=function(t){return ot(t);},Bt=function(t){return at(t);},Gt=function(t){return new D(t);},Jt=function(t){return new N(t);},Yt=function(t,r){return new L(t.trim(),r.trim());},Zt=function(t,r){let{name:i,weight:o}=r;return new U(t.trim(),i,o);},Xt=function(t,r){return l.trackWeight;},er=function(t,r){let i=t.trim();return i.length||Ve("item name"),{name:i,weight:r};},tr=function(t){let r=t.trim();return r.length||Ve("item name"),{name:r,weight:void 0};},rr=function(t){return t*1e3;},sr=function(){return parseFloat(nr());},s=l.peg$currPos|0,S=s,H=[{line:1,column:1}],P=s,re=l.peg$maxFailExpected||[],f=l.peg$silentFails|0,K;if(l.startRule){if(!(l.startRule in c))throw new Error(`Can't start parsing from rule "`+l.startRule+'".');g=c[l.startRule];}function nr(){return n.substring(S,s);}function Sr(){return S;}function yr(){return{source:a,start:S,end:s};}function xr(){return _(S,s);}function Ve(t,r){throw r=r!==void 0?r:_(S,s),De([C(t)],n.substring(S,s),r);}function Er(t,r){throw r=r!==void 0?r:_(S,s),or(t,r);}function T(t,r){return{type:"literal",text:t,ignoreCase:r};}function V(t,r,i){return{type:"class",parts:t,inverted:r,ignoreCase:i};}function ir(){return{type:"any"};}function ar(){return{type:"end"};}function C(t){return{type:"other",description:t};}function Fe(t){var r=H[t],i;if(r)return r;if(t>=H.length)i=H.length-1;else for(i=t;!H[--i];);for(r=H[i],r={line:r.line,column:r.column};i<t;)n.charCodeAt(i)===10?(r.line++,r.column=1):r.column++,i++;return H[t]=r,r;}function _(t,r,i){var o=Fe(t),u=Fe(r),h={source:a,start:{offset:t,line:o.line,column:o.column},end:{offset:r,line:u.line,column:u.column}};return i&&a&&typeof a.offset=="function"&&(h.start=a.offset(h.start),h.end=a.offset(h.end)),h;}function p(t){s<P||(s>P&&(P=s,re=[]),re.push(t));}function or(t,r){return new j(t,null,null,r);}function De(t,r,i){return new j(j.buildMessage(t,r),t,r,i);}function Me(){var t,r,i,o,u,h;for(t=s,r=$(),i=[],o=fe();o!==e;)i.push(o),o=s,u=ze(),u!==e?(u=fe(),u===e?(s=o,o=e):o=u):o=u;return o=ze(),o===e&&(o=null),u=$(),h=Ze(),h!==e?t=i:(s=t,t=e),t;}function ze(){var t,r,i,o;return f++,t=s,r=$(),n.charCodeAt(s)===59?(i=d,s++):(i=e,f===0&&p(yt)),i!==e?(o=$(),r=[r,i,o],t=r):(s=t,t=e),f--,t===e&&(r=e,f===0&&p(St)),t;}function fe(){var t,r,i,o,u,h;return f++,t=s,r=qe(),r===e&&(r=null),i=$(),n.substr(s,2)===x?(o=x,s+=2):(o=e,f===0&&p(Et)),o!==e?(u=$(),h=He(),S=t,t=Kt(r,h)):(s=t,t=e),f--,t===e&&(r=e,f===0&&p(xt)),t;}function qe(){var t,r;return f++,t=lr(),f--,t===e&&(r=e,f===0&&p(ee)),t;}function lr(){var t,r,i,o,u,h,w,B;for(f++,t=s,r=s,i=[],o=Ue();o!==e;)i.push(o),o=s,u=s,h=$(),n.substr(s,2)===R?(w=R,s+=2):(w=e,f===0&&p(At)),w!==e?(B=$(),h=[h,w,B],u=h):(s=u,u=e),u!==e?(u=Ue(),u===e?(s=o,o=e):o=u):o=u;return i.length<1?(s=r,r=e):r=i,r!==e&&(S=t,r=_t(r)),t=r,f--,t===e&&(r=e,f===0&&p(ee)),t;}function Ue(){var t,r,i,o,u,h,w,B;for(f++,t=s,r=s,i=[],o=ue();o!==e;)i.push(o),o=s,u=s,h=$(),n.substr(s,3)===v?(w=v,s+=3):(w=e,f===0&&p(Rt)),w!==e?(B=$(),h=[h,w,B],u=h):(s=u,u=e),u!==e?(u=ue(),u===e?(s=o,o=e):o=u):o=u;return i.length<1?(s=r,r=e):r=i,r!==e&&(S=t,r=Bt(r)),t=r,f--,t===e&&(r=e,f===0&&p(ee)),t;}function ue(){var t,r,i,o,u,h;return f++,t=s,n.substr(s,3)===m?(r=m,s+=3):(r=e,f===0&&p(ce)),r!==e?(i=$(),n.substr(s,3)===m?(o=m,s+=3):(o=e,f===0&&p(ce)),o!==e?(u=$(),h=ue(),h!==e?t=h:(s=t,t=e)):(s=t,t=e)):(s=t,t=e),t===e&&(t=s,n.substr(s,3)===m?(r=m,s+=3):(r=e,f===0&&p(ce)),r!==e?(i=$(),o=Qe(),o!==e?(S=t,t=Gt(o)):(s=t,t=e)):(s=t,t=e),t===e&&(t=s,r=Qe(),r!==e?t=r:(s=t,t=e))),f--,t===e&&(r=e,f===0&&p(ee)),t;}function Qe(){var t,r;return t=s,r=pe(),r!==e&&(S=t,r=Jt(r)),t=r,t;}function He(){var t,r,i,o,u,h,w;for(t=s,r=[],i=ge(),i===e&&(i=he());i!==e;)r.push(i),i=s,o=s,u=$(),n.charCodeAt(s)===44?(h=I,s++):(h=e,f===0&&p(It)),h!==e?(w=$(),u=[u,h,w],o=u):(s=o,o=e),o!==e?(o=ge(),o===e&&(o=he()),o===e?(s=i,i=e):i=o):i=o;return t=r,t;}function ge(){var t,r,i,o;return f++,t=s,r=Ke(),r!==e?(n.charCodeAt(s)===36?(i=Q,s++):(i=e,f===0&&p(Ct)),i!==e?(o=pe(),o!==e?(S=t,t=Yt(r,o)):(s=t,t=e)):(s=t,t=e)):(s=t,t=e),f--,t===e&&(r=e,f===0&&p(ke)),t;}function Ke(){var t,r,i;if(f++,t=s,r=[],i=n.charAt(s),Re.test(i)?s++:(i=e,f===0&&p(We)),i!==e)for(;i!==e;)r.push(i),i=n.charAt(s),Re.test(i)?s++:(i=e,f===0&&p(We));else r=e;return r!==e?t=n.substring(t,s):t=r,f--,t===e&&(r=e,f===0&&p(ke)),t;}function pe(){var t,r,i,o,u;if(f++,t=s,r=s,i=n.charAt(s),wt.test(i)?s++:(i=e,f===0&&p(Tt)),i!==e){for(o=[],u=n.charAt(s),Ie.test(u)?s++:(u=e,f===0&&p(Pe));u!==e;)o.push(u),u=n.charAt(s),Ie.test(u)?s++:(u=e,f===0&&p(Pe));i=[i,o],r=i;}else s=r,r=e;return r!==e?t=n.substring(t,s):t=r,f--,t===e&&(r=e,f===0&&p(Ot)),t;}function he(){var t,r,i,o;return f++,t=s,r=cr(),r!==e?(i=$(),o=Be(),o!==e?(S=t,t=Zt(r,o)):(s=t,t=e)):(s=t,t=e),f--,t===e&&(r=e,f===0&&p(kt)),t;}function cr(){var t,r,i,o,u,h;return f++,t=s,n.charCodeAt(s)===91?(r=dt,s++):(r=e,f===0&&p(Pt)),r!==e?(i=$(),o=_e(),o!==e?(u=$(),n.charCodeAt(s)===93?(h=mt,s++):(h=e,f===0&&p(Nt)),h!==e?t=o:(s=t,t=e)):(s=t,t=e)):(s=t,t=e),f--,t===e&&(r=e,f===0&&p(Wt)),t;}function _e(){var t,r,i;if(f++,t=s,r=[],i=n.charAt(s),Ce.test(i)?s++:(i=e,f===0&&p(Ne)),i!==e)for(;i!==e;)r.push(i),i=n.charAt(s),Ce.test(i)?s++:(i=e,f===0&&p(Ne));else r=e;return r!==e?t=n.substring(t,s):t=r,f--,t===e&&(r=e,f===0&&p(jt)),t;}function Be(){var t,r,i,o,u;for(f++,t=s,r=s,i=[],o=Ge();o!==e;)i.push(o),o=s,u=$(),u=Ge(),u===e?(s=o,o=e):o=u;if(r=n.substring(r,s),i=$(),o=Je(),o!==e?(S=s,u=Xt(r,o),u?u=void 0:u=e,u!==e?(S=t,t=er(r,o)):(s=t,t=e)):(s=t,t=e),t===e){for(t=s,r=s,i=[],o=de();o!==e;)i.push(o),o=s,u=$(),u=de(),u===e?(s=o,o=e):o=u;r=n.substring(r,s),S=t,r=tr(r),t=r;}return f--,t===e&&(r=e,f===0&&p(Lt)),t;}function Ge(){var t,r,i,o,u,h;return f++,t=s,r=s,f++,i=s,o=Je(),o!==e?(u=$(),h=Ze(),h===e&&(h=n.charAt(s),bt.test(h)?s++:(h=e,f===0&&p(Ft))),h!==e?(o=[o,u,h],i=o):(s=i,i=e)):(s=i,i=e),f--,i===e?r=void 0:(s=r,r=e),r!==e?(i=de(),i!==e?t=i:(s=t,t=e)):(s=t,t=e),f--,t===e&&(r=e,f===0&&p(Vt)),t;}function de(){var t,r,i;if(t=s,r=[],i=n.charAt(s),Oe.test(i)?s++:(i=e,f===0&&p(je)),i!==e)for(;i!==e;)r.push(i),i=n.charAt(s),Oe.test(i)?s++:(i=e,f===0&&p(je));else r=e;return r!==e?t=n.substring(t,s):t=r,t;}function Je(){var t,r,i;return f++,t=s,r=Ye(),r!==e?(n.substr(s,2)===Ae?(i=Ae,s+=2):(i=e,f===0&&p(Mt)),i!==e?(S=t,t=rr(r)):(s=t,t=e)):(s=t,t=e),t===e&&(t=s,r=Ye(),r!==e?(n.charCodeAt(s)===103?(i=vt,s++):(i=e,f===0&&p(zt)),i===e&&(i=null),t=r):(s=t,t=e)),f--,t===e&&(r=e,f===0&&p(Dt)),t;}function Ye(){var t,r,i,o,u,h,w;if(f++,t=s,r=[],i=n.charAt(s),X.test(i)?s++:(i=e,f===0&&p(te)),i!==e)for(;i!==e;)r.push(i),i=n.charAt(s),X.test(i)?s++:(i=e,f===0&&p(te));else r=e;if(r!==e){if(i=s,n.charCodeAt(s)===46?(o=$t,s++):(o=e,f===0&&p(Ut)),o!==e){if(u=s,h=[],w=n.charAt(s),X.test(w)?s++:(w=e,f===0&&p(te)),w!==e)for(;w!==e;)h.push(w),w=n.charAt(s),X.test(w)?s++:(w=e,f===0&&p(te));else h=e;h!==e?u=n.substring(u,s):u=h,u!==e?(o=[o,u],i=o):(s=i,i=e);}else s=i,i=e;i===e&&(i=null),S=t,t=sr();}else s=t,t=e;return f--,t===e&&(r=e,f===0&&p(qt)),t;}function $(){var t,r;for(f++,t=[],r=n.charAt(s),Te.test(r)?s++:(r=e,f===0&&p(Le));r!==e;)t.push(r),r=n.charAt(s),Te.test(r)?s++:(r=e,f===0&&p(Le));return f--,r=e,f===0&&p(Qt),t;}function Ze(){var t,r;return t=s,f++,n.length>s?(r=n.charAt(s),s++):(r=e,f===0&&p(Ht)),f--,r===e?t=void 0:(s=t,t=e),t;}if(K=g(),l.peg$library)return{peg$result:K,peg$currPos:s,peg$FAILED:e,peg$maxFailExpected:re,peg$maxFailPos:P};if(K!==e&&s===n.length)return K;throw K!==e&&s<n.length&&p(ar()),De(re,P<n.length?n.charAt(P):null,P<n.length?_(P,P+1):_(P,P));}var pr={isTrackWeight:()=>!1},hr=new q("PARSER_CONFIG_PROVIDER"),ne=(()=>{class n{config=b(hr,{optional:!0})??pr;isTrackWeight(){return this.config.isTrackWeight();}makeOptions(e,a={}){return{startRule:e,trackWeight:a.forceWeightTracking??this.isTrackWeight()};}parseCondition(e){return W(e,this.makeOptions("Condition"));}parseQuestion(e){return W(e,this.makeOptions("Question"));}parseItem(e){return W(e,this.makeOptions("Item"));}parseEffects(e){return W(e,this.makeOptions("Effects"));}parseRule(e){return W(e,this.makeOptions("Rule"));}parseRules(e){let a=e.split(/\r?\n/g).map(c=>c.replace(/#.*/,"")).join(`
`);try{return W(a,this.makeOptions("Rules"));}catch(c){let g=[];if(g.push("Error parsing rules"),c instanceof j){let d=c.location.start.line.toString(),x=c.location.start.column.toString();g.push(" at line ",d," column ",x),g.push(":",`
`,c.message);}else console.error(c);throw new Error(g.join(""));}}validateVariableName(e){W(e,this.makeOptions("VariableName"));}validateQuestionString(e){W(e,this.makeOptions("QuestionString"));}validateItemNameAndWeight(e){W(e,this.makeOptions("ItemNameAndWeight"));}validateCategoryName(e){W(e,this.makeOptions("CategoryName"));}forceParseWeight(e){return W(e,this.makeOptions("ItemNameAndWeight",{forceWeightTracking:!0})).weight??0;}static ɵfac=function(a){return new(a||n)();};static ɵprov=k({token:n,factory:n.ɵfac,providedIn:"root"});}return n;})();var $e=(()=>{class n{parser=b(ne);extractVariables(e){return e.reduce((a,c)=>[...a,...c.questions.map(g=>g.variable)],[]);}extractCategories(e){let a=new Set();for(let c of e)for(let g of c.items)a.add(g.category);return Array.from(a);}renameVariable(e,a,c){if(c instanceof Array)return c.map(d=>this.renameVariable(e,a,d));if(c instanceof L)return c.variable===e?new L(c.question,a):c;if(c instanceof F)return new F(this.renameVariable(e,a,c.condition),c.questions.map(d=>this.renameVariable(e,a,d)),c.items);if(c instanceof N)return c.variable===e?new N(a):c;if(c instanceof D)return new D(this.renameVariable(e,a,c.not));if(c instanceof M)return new M(this.renameVariable(e,a,c.left),this.renameVariable(e,a,c.right));if(c instanceof z)return new z(this.renameVariable(e,a,c.left),this.renameVariable(e,a,c.right));let g=c;throw new Error("Unknown item type: "+g);}filterActive(e){let a=e.rules.filter(g=>g.condition.evaluate(e.model)),c=this.extractVariables(a).reduce((g,d)=>se(E({},g),{[d]:e.model[d]}),{[G.string]:!0});return a.length===e.rules.length?{model:c,rules:a}:this.filterActive({model:c,rules:a});}contains(e,a){let c=a.toLowerCase();if(e instanceof F)return this.contains(e.condition,a)||e.questions.some(d=>this.contains(d,a))||e.items.some(d=>this.contains(d,a));if(e instanceof L)return e.question.toLowerCase().includes(c)||e.variable.toLowerCase().includes(c);if(e instanceof U)return e.category.toLowerCase().includes(c)||e.name.toLowerCase().includes(c);if(e instanceof N)return e.variable.toLowerCase().includes(c);if(e instanceof D)return this.contains(e.not,a);if(e instanceof M)return this.contains(e.left,a)||this.contains(e.right,a);if(e instanceof z)return this.contains(e.left,a)||this.contains(e.right,a);let g=e;throw new Error("Unknown item type: "+g);}countItemsAndWeights(e){return e.reduce((a,c)=>c.items.reduce((g,d)=>{let x;return this.parser.isTrackWeight()?x=d.weight?1:0:x=this.parser.forceParseWeight(d.name)?1:0,{items:g.items+1,weights:g.weights+x};},a),{items:0,weights:0});}static ɵfac=function(a){return new(a||n)();};static ɵprov=k({token:n,factory:n.ɵfac,providedIn:"root"});}return n;})();function ie(n,l){let e=n.getItem("state"),a;if(e){let c=JSON.parse(e);a=E(E({},l),c);}else a=E({},l);return a;}function lt(n,l){if(typeof n!=typeof l)return!1;if(n&&l&&typeof n=="object"){let e=Object.keys(n),a=Object.keys(l);return e.length===a.length&&e.every(c=>lt(n[c],l[c]));}return n===l;}function dr(n,l){let e=Object.keys(l).filter(a=>!lt(n[a],l[a])).map(a=>[a,n[a]]);return e.length===0?null:Object.fromEntries(e);}function ae(n,l,e){let a=dr(l,e);a===null?n.removeItem("state"):n.setItem("state",JSON.stringify(a));}var ct=["en","de"],Y={rules:void 0,answers:{},checkedItems:[],collapsedCategories:[],categorySorting:"alphabetically",trackWeight:!1,answersLocked:!1,fadeOutDisabledRules:!1,highlightVariableStatus:!1,refactorVariables:!0,theme:"system",fontSize:"normal",accessibility:"accessible",language:"auto",exportReminder:!1,lastExportHash:"",lastExportDate:0},we=(()=>{class n{state=ie(localStorage,Y);persist(){ae(localStorage,this.state,Y);}initialState=Y;triggerReset=A(0);createSignal=e=>{let a=A(this.state[e]);return O(()=>{let c=a();c!==this.state[e]&&(this.state[e]=c,this.persist());},{manualCleanup:!0}),O(()=>{this.triggerReset()&&a.set(Y[e]);}),a;};reset(){this.state=E({},Y),this.persist(),this.triggerReset.set(Date.now());}static ɵfac=function(a){return new(a||n)();};static ɵprov=k({token:n,factory:n.ɵfac,providedIn:"root"});}return n;})();var oe={rulesMode:"view",filterRulesQuery:void 0},be=(()=>{class n{initialState=oe;triggerReset=A(0);createSignal(e){let a=b(it),c=b(nt),g=A(void 0);return a.events.pipe(et(d=>d instanceof st),Xe(()=>c.snapshot.queryParams[e]??oe[e])).subscribe(d=>{d!==""&&g.set(d);}),O(()=>{let d=g()||void 0;d===oe[e]&&(d=void 0),c.snapshot.queryParams[e]!==d&&a.navigate([],{queryParams:{[e]:d},queryParamsHandling:"merge",relativeTo:c,replaceUrl:!0});}),O(()=>{this.triggerReset()&&g.set(oe[e]);}),g;}reset(){this.triggerReset.set(Date.now());}static ɵfac=function(a){return new(a||n)();};static ɵprov=k({token:n,factory:n.ɵfac,providedIn:"root"});}return n;})();var Z={clipboardItems:[],clipboardQuestions:[]},Se=(()=>{class n{state=ie(sessionStorage,Z);initialState=Z;triggerReset=A(0);createSignal=e=>{let a=A(this.state[e]);return O(()=>{let c=a();c!==this.state[e]&&(this.state[e]=c,this.persist());},{manualCleanup:!0}),O(()=>{this.triggerReset()&&a.set(Z[e]);}),a;};persist(){ae(sessionStorage,this.state,Z);}reset(){this.state=E({},Z),this.persist(),this.triggerReset();}static ɵfac=function(a){return new(a||n)();};static ɵprov=k({token:n,factory:n.ɵfac,providedIn:"root"});}return n;})();var ye={serviceWorkerStatus:"init"},xe=(()=>{class n{initialState=ye;triggerReset=A(0);createSignal(e){let a=A(ye[e]);return O(()=>{this.triggerReset()&&a.set(ye[e]);}),a;}reset(){this.triggerReset();}static ɵfac=function(a){return new(a||n)();};static ɵprov=k({token:n,factory:n.ɵfac,providedIn:"root"});}return n;})();var ft=({language:n})=>{let l=A(window.scrollY);return window.addEventListener("scroll",()=>{l.set(window.scrollY);}),{scrollY:l,isMobile:y(()=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini|Mobile|mobile|CriOS/i.test(navigator.userAgent)),preferredLanguage:y(()=>{let e=n();return e==="auto"?navigator.languages.map(g=>g.split("-")[0]).find(g=>ct.includes(g))??"en":e;})};};var ut=({parsedRules:n,answers:l})=>{let e=b($e),a=y(()=>e.filterActive({rules:n(),model:l()})),c=y(()=>a().rules);return{categories:y(()=>e.extractCategories(n())),variables:y(()=>e.extractVariables(n())),activeRules:c,activeAnswers:y(()=>a().model),activeQuestions:y(()=>c().flatMap(g=>g.questions)),activeItems:y(()=>c().flatMap(g=>g.items))};};var gt=`:-
   [Utility] Paper Tissues,
   [Utility] Backpack;

:- Are you traveling longer than 3 days? $longer;

longer :-
   Do you have a washer or laundry service available? $laundry,
   Do you want to work? $work,
   [Electronics] Phone Charger,
   [Electronics] Tablet;

longer AND NOT laundry :-
   [Clothes] enough Shirts,
   [Clothes] enough Underwear,
   [Clothes] spare Pants;

laundry :-
   [Clothes] 3 Shirts,
   [Clothes] 3 sets of Underwear;

work :-
   [Electronics] Laptop;

:-
   Will it be sunny? $sunny,
   Will it be rainy? $rainy,
   Are you traveling abroad? $abroad;

sunny :-
   Do you expect a high UV index? $uv,
   [Utility] Sunglasses,
   [Clothes] Short Pants;

rainy :-
   [Clothes] Rain Jacket;

NOT rainy :-
   [Clothes] Jacket;

NOT sunny :-
   [Clothes] Long Pants;

uv :-
   [Utility] Sunscreen;

abroad :-
   [Documents] Passport,
   [Documents] Visa;
`;var pt=`:-
   [N\xFCtzliches] Papiertaschent\xFCcher,
   [N\xFCtzliches] Rucksack;

:- Reist du l\xE4nger als 3 Tage? $longer;

longer :-
   Hast du eine Waschmaschine oder einen W\xE4scheservice zur Verf\xFCgung? $laundry,
   Willst du arbeiten? $work,
   [Elektronik] Handy-Ladeger\xE4t,
   [Elektronik] Tablet;

longer AND NOT laundry :-
   [Kleidung] genug Hemden,
   [Kleidung] genug Unterw\xE4sche,
   [Kleidung] Ersatzhosen;

laundry :-
   [Kleidung] 3 Hemden,
   [Kleidung] 3 S\xE4tze Unterw\xE4sche;

work :-
   [Elektronik] Laptop;

:-
   Wird es sonnig sein? $sunny,
   Wird es regnerisch sein? $rainy,
   Reist du ins Ausland? $abroad;

sunny :-
   Erwartest du einen hohen UV-Index? $uv,
   [N\xFCtzliches] Sonnenbrille,
   [Kleidung] Kurze Hosen;

rainy :-
   [Kleidung] Regenjacke;

NOT rainy :-
   [Kleidung] Jacke;

NOT sunny :-
   [Kleidung] Lange Hosen;

uv :-
   [N\xFCtzliches] Sonnencreme;

abroad :-
   [Dokumente] Reisepass,
   [Dokumente] Visum;
`;var Ee=new q("RULES_TEMPLATE");function mr(n){return n.startsWith("de")?pt:gt;}function Es(){return tt([{provide:Ee,useFactory:mr,deps:[rt]}]);}var ht=({rules:n,lastExportHash:l})=>{let e=b(Ee),a=y(()=>n()??e),c=b(ne),g=y(()=>{try{return{parsedRules:c.parseRules(a()),ruleParserError:""};}catch(R){R instanceof Error?console.warn(R.message):console.error(R);let v=R instanceof Error?R.message:"An unknown error occurred";return{parsedRules:[],ruleParserError:v};}}),d=A(new Date().getTime());O(()=>{a(),d.set(new Date().getTime());});let x=y(()=>vr(a()).toString(16));return{rulesOrTemplate:a,parsedRules:y(()=>g().parsedRules),ruleParserError:y(()=>g().ruleParserError),lastRulesAction:d,rulesHash:x,exportNeeded:y(()=>!!n()&&x()!==l())};},vr=function(n,l=0){let e=3735928559^l,a=1103547991^l;for(let c=0,g;c<n.length;c++)g=n.charCodeAt(c),e=Math.imul(e^g,2654435761),a=Math.imul(a^g,1597334677);return e=Math.imul(e^e>>>16,2246822507),e^=Math.imul(a^a>>>13,3266489909),a=Math.imul(a^a>>>16,2246822507),a^=Math.imul(e^e>>>13,3266489909),4294967296*(2097151&a)+(e>>>0);};var le=class n{state;constructor(l){this.state=l;}static builder(){return new n({});}extend(l){let e=Object.keys(l.initialState).reduce((a,c)=>se(E({},a),{[c]:l.createSignal(c)}),{});return new n(E(E({},this.state),e));}derive(l){return new n(E(E({},this.state),l(this.state)));}build(){return this.state;}};var $r=new q("GLOBAL_STATE",{providedIn:"root",factory:()=>br()}),wr=new q("RESET_SWITCH",{providedIn:"root",factory:()=>{let n=[b(we),b(be),b(Se),b(xe)];return()=>{n.forEach(l=>{l.reset();});};}});function br(){return le.builder().extend(b(we)).extend(b(be)).extend(b(Se)).extend(b(xe)).derive(ft).derive(ht).derive(ut).build();}export{fr as a,me as b,F as c,L as d,U as e,N as f,Ir as g,G as h,D as i,M as j,z as k,j as l,hr as m,ne as n,$e as o,Es as p,$r as q,wr as r};/**i18n:015bdb808d2848989c3b91cbfc9cad629f58047ff6617f7ac5d9a7ed8c5b6894*/