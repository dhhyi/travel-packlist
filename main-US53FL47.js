import{a as I}from"./chunk-XAFSYTQE.js";import{a as De}from"./chunk-JCMWV7PE.js";import{a as Me,b as y}from"./chunk-R2QRPLUN.js";import{k as Fe,o as a}from"./chunk-WU25SZS2.js";import{b as Ae,f as Y,g as Ie,j as xe,k as U,l as Re,m as _e,n as Pe,o as Ne,p as Oe,q as ke}from"./chunk-TNXYQ7TE.js";import{$ as B,$a as ge,$b as F,A as E,Aa as K,Ab as Ce,B as l,Bb as ye,G as v,Ha as fe,I as ne,N as se,Q as p,S as C,Sa as M,W as u,Ya as he,Z as ae,Zb as Se,aa as n,ab as D,c as P,cb as X,da as le,ec as Te,g as te,gc as L,hb as ve,ib as we,ja as pe,k as re,ka as ce,l as N,la as me,m as oe,nb as f,oa as k,ob as w,p as m,pb as h,rb as be,sa as ue,t as ie,u as H,va as de,w as Z,wb as Ee,y as O,z as A}from"./chunk-6EH5NXRP.js";import"./chunk-VLQQUFES.js";import{a as j}from"./chunk-M3ELZOQ4.js";import{a as ee}from"./chunk-2NFLSA4Y.js";var V=class r{class=de("h-[1rem] w-[1rem]");static \u0275fac=function(t){return new(t||r)};static \u0275cmp=M({type:r,selectors:[["app-icon-cog"]],inputs:{class:[1,"class"]},decls:2,vars:2,consts:[["xmlns","http://www.w3.org/2000/svg","viewBox","0 -960 960 960"],["d","m370-80-16-128q-13-5-24.5-12T307-235l-119 50L78-375l103-78q-1-7-1-13.5v-27q0-6.5 1-13.5L78-585l110-190 119 50q11-8 23-15t24-12l16-128h220l16 128q13 5 24.5 12t22.5 15l119-50 110 190-103 78q1 7 1 13.5v27q0 6.5-2 13.5l103 78-110 190-118-50q-11 8-23 15t-24 12L590-80H370Zm70-80h79l14-106q31-8 57.5-23.5T639-327l99 41 39-68-86-65q5-14 7-29.5t2-31.5q0-16-2-31.5t-7-29.5l86-65-39-68-99 42q-22-23-48.5-38.5T533-694l-13-106h-79l-14 106q-31 8-57.5 23.5T321-633l-99-41-39 68 86 64q-5 15-7 30t-2 32q0 16 2 31t7 30l-86 65 39 68 99-42q22 23 48.5 38.5T427-266l13 106Zm42-180q58 0 99-41t41-99q0-58-41-99t-99-41q-59 0-99.5 41T342-480q0 58 40.5 99t99.5 41Zm-2-140Z"]],template:function(t,o){t&1&&(me(),f(0,"svg",0),h(1,"path",1),w()),t&2&&ve(o.class())},encapsulation:2,changeDetection:0})};function He(r,e){if(r&1){let t=be();f(0,"div",8)(1,"button",9),Ce("click",function(){pe(t);let i=ye();return ce(i.scrollTop())}),h(2,"app-icon-up",6),w()()}}var q=class r{state=n(a);scrollTopVisible=Te(()=>this.state.signal("scrollY")()>100);scrollTop(){window.scrollTo({top:0,behavior:"smooth"})}static \u0275fac=function(t){return new(t||r)};static \u0275cmp=M({type:r,selectors:[["app-root"]],decls:11,vars:1,consts:()=>{let e;e=$localize`:@@app.icon:application icon`;let t;return t=$localize`:@@app.title:Travel Packlist`,[t,[1,"flex","h-[3rem]","flex-row","items-center","pb-2"],["routerLink","/",1,"flex","grow"],["alt",e,"src","icon.svg",1,"h-8"],[1,"text-xl","font-bold"],["routerLink","/config","routerLinkActive","hidden",1,"pr-2"],[1,"h-6","w-6"],[1,"flex","grow","flex-col","pb-[3.5rem]"],[1,"fixed","bottom-2","left-1/2","-translate-x-1/2"],["type","button",1,"flex","w-full","items-center","justify-center","rounded-3xl","border","border-slate-300","shadow-xl",3,"click"]]},template:function(t,o){t&1&&(f(0,"nav",1)(1,"a",2),h(2,"img",3),f(3,"span",4),Ee(4,0),w()(),f(5,"a",5),h(6,"app-icon-cog",6),w()(),f(7,"div",7),h(8,"router-outlet"),he(9,He,3,0,"div",8),w(),h(10,"app-dialog")),t&2&&(fe(9),we(o.scrollTopVisible()?9:-1))},dependencies:[ke,xe,Re,_e,V,De,Me],styles:["[_nghost-%COMP%]{display:flex;height:100%;flex-direction:column}"],changeDetection:0})};var _="Service workers are disabled or not supported by this browser";function Ze(r){return H(()=>oe(new Error(r)))}var S=class{serviceWorker;worker;registration;events;constructor(e){if(this.serviceWorker=e,!e)this.worker=this.events=this.registration=Ze(_);else{let o=Z(e,"controllerchange").pipe(m(()=>e.controller)),i=H(()=>N(e.controller)),c=ie(i,o);this.worker=c.pipe(l(b=>!!b)),this.registration=this.worker.pipe(p(()=>e.getRegistration()));let T=Z(e,"message").pipe(m(b=>b.data)).pipe(l(b=>b&&b.type)).pipe(se());T.connect(),this.events=T}}postMessage(e,t){return this.worker.pipe(v(1),C(o=>{o.postMessage(ee({action:e},t))})).toPromise().then(()=>{})}postMessageWithOperation(e,t,o){let i=this.waitForOperationCompleted(o),c=this.postMessage(e,t);return Promise.all([c,i]).then(([,s])=>s)}generateNonce(){return Math.round(Math.random()*1e7)}eventsOfType(e){let t;return typeof e=="string"?t=o=>o.type===e:t=o=>e.includes(o.type),this.events.pipe(l(t))}nextEventOfType(e){return this.eventsOfType(e).pipe(v(1))}waitForOperationCompleted(e){return this.eventsOfType("OPERATION_COMPLETED").pipe(l(t=>t.nonce===e),v(1),m(t=>{if(t.result!==void 0)return t.result;throw new Error(t.error)})).toPromise()}get isEnabled(){return!!this.serviceWorker}},Be=(()=>{class r{sw;messages;notificationClicks;subscription;get isEnabled(){return this.sw.isEnabled}pushManager=null;subscriptionChanges=new te;constructor(t){if(this.sw=t,!t.isEnabled){this.messages=E,this.notificationClicks=E,this.subscription=E;return}this.messages=this.sw.eventsOfType("PUSH").pipe(m(i=>i.data)),this.notificationClicks=this.sw.eventsOfType("NOTIFICATION_CLICK").pipe(m(i=>i.data)),this.pushManager=this.sw.registration.pipe(m(i=>i.pushManager));let o=this.pushManager.pipe(p(i=>i.getSubscription()));this.subscription=A(o,this.subscriptionChanges)}requestSubscription(t){if(!this.sw.isEnabled||this.pushManager===null)return Promise.reject(new Error(_));let o={userVisibleOnly:!0},i=this.decodeBase64(t.serverPublicKey.replace(/_/g,"/").replace(/-/g,"+")),c=new Uint8Array(new ArrayBuffer(i.length));for(let s=0;s<i.length;s++)c[s]=i.charCodeAt(s);return o.applicationServerKey=c,this.pushManager.pipe(p(s=>s.subscribe(o)),v(1)).toPromise().then(s=>(this.subscriptionChanges.next(s),s))}unsubscribe(){if(!this.sw.isEnabled)return Promise.reject(new Error(_));let t=o=>{if(o===null)throw new Error("Not subscribed to push notifications.");return o.unsubscribe().then(i=>{if(!i)throw new Error("Unsubscribe failed!");this.subscriptionChanges.next(null)})};return this.subscription.pipe(v(1),p(t)).toPromise()}decodeBase64(t){return atob(t)}static \u0275fac=function(o){return new(o||r)(B(S))};static \u0275prov=u({token:r,factory:r.\u0275fac})}return r})(),J=(()=>{class r{sw;versionUpdates;unrecoverable;get isEnabled(){return this.sw.isEnabled}constructor(t){if(this.sw=t,!t.isEnabled){this.versionUpdates=E,this.unrecoverable=E;return}this.versionUpdates=this.sw.eventsOfType(["VERSION_DETECTED","VERSION_INSTALLATION_FAILED","VERSION_READY","NO_NEW_VERSION_DETECTED"]),this.unrecoverable=this.sw.eventsOfType("UNRECOVERABLE_STATE")}checkForUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(_));let t=this.sw.generateNonce();return this.sw.postMessageWithOperation("CHECK_FOR_UPDATES",{nonce:t},t)}activateUpdate(){if(!this.sw.isEnabled)return Promise.reject(new Error(_));let t=this.sw.generateNonce();return this.sw.postMessageWithOperation("ACTIVATE_UPDATE",{nonce:t},t)}static \u0275fac=function(o){return new(o||r)(B(S))};static \u0275prov=u({token:r,factory:r.\u0275fac})}return r})();var Le=new ae("");function Ke(r,e,t,o){return()=>{if(!(Y(o)&&"serviceWorker"in navigator&&t.enabled!==!1))return;let i=r.get(ue),c=r.get(X);i.runOutsideAngular(()=>{let d=navigator.serviceWorker,g=()=>d.controller?.postMessage({action:"INITIALIZE"});d.addEventListener("controllerchange",g),c.onDestroy(()=>{d.removeEventListener("controllerchange",g)})});let s;if(typeof t.registrationStrategy=="function")s=t.registrationStrategy();else{let[d,...g]=(t.registrationStrategy||"registerWhenStable:30000").split(":");switch(d){case"registerImmediately":s=N(null);break;case"registerWithDelay":s=Ue(+g[0]||0);break;case"registerWhenStable":let T=re(r.get(X).whenStable());s=g[0]?A(T,Ue(+g[0])):T;break;default:throw new Error(`Unknown ServiceWorker registration strategy: ${t.registrationStrategy}`)}}i.runOutsideAngular(()=>s.pipe(v(1)).subscribe(()=>navigator.serviceWorker.register(e,{scope:t.scope}).catch(d=>console.error("Service worker registration failed with:",d))))}}function Ue(r){return N(null).pipe(ne(r))}function Xe(r,e){return new S(Y(e)&&r.enabled!==!1?navigator.serviceWorker:void 0)}var R=class{enabled;scope;registrationStrategy};function je(r,e={}){return le([Be,J,{provide:Le,useValue:r},{provide:R,useValue:e},{provide:S,useFactory:Xe,deps:[R,K]},{provide:ge,useFactory:Ke,deps:[k,Le,R,K],multi:!0}])}var Ve=!1,qe=async()=>{if(n(a).get("rulesContainComments")&&!Ve){let e=await y($localize`:@@config.rules.edit.discard-comments:The current rules contain comments. Editing them with the graphical editor will discard these comments. Do you want to proceed?`);return e&&(Ve=!0),e}return!0};var Q=()=>{let r=n(a),e=n(U),t=r.get("ruleParserError");return t?e.createUrlTree(["/rules-error"],{queryParams:{error:t}}):!0};var We=[{path:"",redirectTo:"/packlist",pathMatch:"full"},{path:"packlist",loadComponent:()=>import("./chunk-7XC3ZQ2N.js"),canActivate:[Q]},{path:"config",loadComponent:()=>import("./chunk-7R425KKY.js")},{path:"rules",loadComponent:()=>import("./chunk-B3EVSN4F.js"),canActivate:[Q,qe]},{path:"rules-raw",loadComponent:()=>import("./chunk-533Q6NPB.js")},{path:"rules-error",loadComponent:()=>import("./chunk-IRFYQM43.js")},{path:"documentation",loadComponent:()=>import("./chunk-OMBM755C.js")},{path:"**",redirectTo:"/packlist"}];var W=class r{injector=n(k);document=n(Ae);init(){let e=this.injector.get(a),t=e.signal("theme");L(()=>{this.applyTheme(t())});let o=e.signal("preferredLanguage");L(()=>{this.applyLanguage(o())});let i=e.signal("fontSize");L(()=>{this.applyFontSize(i())})}applyTheme(e){let t=window.matchMedia("(prefers-color-scheme: dark)").matches;e==="system"&&t||e==="dark"?this.document.documentElement.classList.add("dark"):this.document.documentElement.classList.remove("dark")}applyLanguage(e){if(e&&this.document.documentElement.lang!==e){if(F()){console.warn("Language switching is disabled in dev mode");return}let t=window.location.href,o=window.location.hash,i=`index${e==="en"?"":`.${e}`}.html`,s=t.substring(0,t.indexOf(o))+i+window.location.hash;setTimeout(()=>{window.location.href=s},0)}}applyFontSize(e){document.documentElement.style.setProperty("--html-font-size",e==="small"?"16px":e==="normal"?"18px":"20px")}static \u0275fac=function(t){return new(t||r)};static \u0275prov=u({token:r,factory:r.\u0275fac,providedIn:"root"})};var G=class r{swUpdate=n(J);status=n(a).signal("serviceWorkerStatus");init(){A(this.swUpdate.versionUpdates,this.swUpdate.unrecoverable).pipe(C(e=>{if(e.type==="VERSION_INSTALLATION_FAILED")this.status.set("error"),console.error(`Version installation failed
`,e.error);else if(e.type==="NO_NEW_VERSION_DETECTED")this.status.set("ok");else if(e.type==="VERSION_READY"||e.type==="VERSION_DETECTED")this.status.set("update-available");else{let t=e;this.status.set("unrecoverable"),console.error(`Unrecoverable state
`,t.reason)}}),l(e=>e.type==="VERSION_READY"),p(()=>y($localize`:@@app.update.apply.question:A new version of the app is available. Do you want to reload?`)),l(P)).subscribe(()=>{window.location.reload()}),this.swUpdate.isEnabled?O(6e4).pipe(p(()=>this.swUpdate.checkForUpdate())).subscribe(e=>{e&&console.log("Update available")}):(this.status.set("disabled"),console.warn("Service worker updates are disabled/unavailable"))}static \u0275fac=function(t){return new(t||r)};static \u0275prov=u({token:r,factory:r.\u0275fac,providedIn:"root"})};var Ye=j("Filesystem",{web:()=>import("./chunk-MGDTWOGH.js").then(r=>new r.FilesystemWeb)});var Je=j("Share",{web:()=>import("./chunk-BKRSAL3V.js").then(r=>new r.ShareWeb)});var $=class extends I{state=n(a);async webShareRules(){let e=this.state.get("rules");if(!e){console.error("No rules available");return}let t=this.state.get("exportFileName");await navigator.share({title:t,files:[new File([e],t,{type:"text/plain"})]})}downloadRules(){let e=this.state.get("rules");if(!e){console.error("No rules available");return}let t=new Blob([e],{type:"text/plain"}),o=URL.createObjectURL(t),i=document.createElement("a");i.href=o,i.download=this.state.get("exportFileName"),i.click()}async exportRules(){this.state.get("isMobile")&&"share"in navigator?await this.webShareRules():this.downloadRules()}};var z=class r{router=n(U);state=n(a);exportNeeded=this.state.signal("exportNeeded");reminderActive=this.state.signal("exportReminder");lastAskedHash=[];init(){O(3e4).pipe(l(()=>this.reminderActive()&&this.exportNeeded()&&this.exportOverdue()&&this.enoughTimeSinceLastEditPassed()),m(()=>this.state.get("rulesHash")),l(e=>!this.lastAskedHash.includes(e)),C(e=>{this.lastAskedHash.push(e)}),p(()=>y($localize`:@@config.rules.export-reminder.question:The current rules haven't been exported for some time now. Do you want to export them now?`)),l(P)).subscribe(()=>{this.router.navigate(["/config"],{fragment:"export-now"})})}exportOverdue(){let e=this.state.get("lastExportDate");return new Date().getTime()-e>Ge(10)}enoughTimeSinceLastEditPassed(){let e=this.state.get("lastRulesAction");return new Date().getTime()-e>Ge(2)}static \u0275fac=function(t){return new(t||r)};static \u0275prov=u({token:r,factory:r.\u0275fac,providedIn:"root"})};function Ge(r){return r*60*1e3}function Qe(r){return{isTrackWeight:r.signal("trackWeight")}}var $e={providers:[Se(),Pe(We,Ne(),Oe()),je("ngsw-worker.js",{enabled:!F()&&!0,registrationStrategy:"registerImmediately"}),D(()=>{n(W).init()}),D(()=>{n(G).init()}),D(()=>{n(z).init()}),{provide:Fe,useFactory:Qe,deps:[a]},{provide:I,useClass:$}]};Ie(q,$e).catch(r=>{console.error(r)});
